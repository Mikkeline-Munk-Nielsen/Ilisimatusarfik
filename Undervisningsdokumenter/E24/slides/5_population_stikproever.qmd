---
format: 
  revealjs:
    theme: css_etc/custom-theme-ilisimatusarfik.css
    slide-level: 0  # Disable automatic slide creation from headings
    incremental: false 
    logo: css_etc/ilisimatusarfik.png
editor: visual
---

::: center
# Populationer og stikpr√∏ver

### Statistik E24 (15 ECTS)

### ved Mikkeline Munk Nielsen
:::

------------------------------------------------------------------------

# Program

-   Hvad er populationer og stikpr√∏ver?
-   Hvordan udtr√¶kker man stikpr√∏ver?
-   Hvorfor stikpr√∏ver introducerer statistisk usikkerhed
-   Hvordan regner vi p√• statistisk usikkerhed?

------------------------------------------------------------------------

# Populationer

I statistik betegnes en population som den m√¶ngde af enheder, som vi gerne vil udtale os om. Hvis vi gerne vil udtale os om aldersfordelingen blandt borgere i Gr√∏nland er populationen alts√• samtlige borgere i Gr√∏nland. Man skelner dog mellem:

<br>

-   **Universet/populationen (target population):** den m√•lgruppe, hvori en stikpr√∏ve tr√¶kkes

-   **Den mulige population (frame population):** den del af universet, som faktisk *kan* udtr√¶kkes og dermed har mulighed for at indg√• i stikpr√∏ven

------------------------------------------------------------------------

# Populationer

-   Hvis vi har information p√• ALLE de enheder, som vi gerne vil udtale os om har vi mulighed for at lave populationsunders√∏gelser/totalunders√∏gelser

-   Registerunders√∏gelser er det, der kommer t√¶ttest p√•: <https://stat.gl/default.asp?lang=da>

-   Oftest har vi dog hverken tid eller r√•d til at gennemf√∏re populationsunders√∏gelser...

------------------------------------------------------------------------

# Stikpr√∏ver

En stikpr√∏ve er en lille del af universet, der udv√¶lges til at repr√¶sentere/beskrive hele universet ![](images/udtraek.png)

------------------------------------------------------------------------

# Udtr√¶k af stikpr√∏ver

Selvom mange observationer umiddelbart er godt, s√• er m√•den, hvorp√• en stikpr√∏ve udtr√¶kkes faktisk meget vigtigere for repr√¶sentativiteten end st√∏rrelsen p√• stikpr√∏ven. I skal kende f√∏lgende tre strategier:

<br>

-   Simpel tilf√¶ldig (Gold standard)

-   Stratificeret: reduceret variation inden for strata

-   Klynge: Udtr√¶k af klynger (ikke enkelte enheder)

------------------------------------------------------------------------

# Simpel tilf√¶ldigt udtr√¶k

::::: two-column-layout
::: left-column
-   Hver observation i populationen har lige sandsynlighed for at blive udtrukket
-   Anses som "gold standard" for stikpr√∏veudtagning
-   Bruges til at minimere bias og sikre, at stikpr√∏ven repr√¶senterer hele populationen
:::

::: right-column
![](images/numbers_from_hat.jpg)
:::
:::::

------------------------------------------------------------------------

# Stratificeret udtr√¶k

::::: two-column-layout
::: left-column
-   Populationen opdeles i strata (grupper) baseret p√• en relevant variabel (fx kommune, k√∏n)
-   Tilf√¶ldig udtr√¶kning sker inden for hver stratum
-   Reduceret variation inden for hvert stratum (enheder er ens inden for strata, i princippet)
-   Form√•let er at sikre, at alle vigtige undergrupper er repr√¶senterede
:::

::: right-column
![](images/kommuner.png){width="75%"}
:::
:::::

------------------------------------------------------------------------

# Klyngeudtr√¶k

::::: two-column-layout
::: left-column
-   Populationen opdeles i klynger (fx skoler, husstande), og udtr√¶kning sker p√• klyngeniveau (ikke inden for klynger, ligesom med stata)

-   Udv√¶lger hele klynger fremfor enkeltindivider inden for populationen

-   Effektiv, n√•r det er praktisk at udtr√¶kke data fra grupper fremfor hele populationen

-   Velegnet til store geografiske eller administrative enheder, hvor stikpr√∏ver er sv√¶re at indsamle
:::

::: right-column
![](images/huse.jpg)
:::
:::::

------------------------------------------------------------------------

# Udtagning

I praksis kan man udtr√¶kke stikpr√∏ver fra populationer med udgangspunkt i forskellige typer af information. Traditionelle samplingmetoder inkluderer:

-   Registerbaseret sampling (fulde populationslister)

-   Telefonnummerbaseret sampling (hustands eller individ niveau? Tidspunkt for kontakt?)

-   Internetpanelsampling (mange besvarelser, sv√¶rt at sikre repr√¶sentativitet, adgang til sv√¶rt tilg√¶ngelige m√•lgrupper)

-   Bekvemmelighedssampling (f.eks. Facebook, som udgangspunkt ikke repr√¶sentativt da det ikke er tilf√¶ldig udv√¶lgelse)

---

## Case 1: Kundetilfredshed i butiksk√¶de 

**Case**: En gr√∏nlandsk butiksk√¶de med butikker i Nuuk, Sisimiut og Ilulissat √∏nsker at unders√∏ge kundetilfredshed. K√¶den har samlet set 5.000 faste kunder, men det er for dyrt og tidskr√¶vende at sp√∏rge dem alle. De beslutter at lave en stikpr√∏ve.

**Opgaver:**

1.  Definer target population og frame population

2.  Hvordan vil I sammens√¶tte stikpr√∏ven, s√• kunder fra alle tre byer er repr√¶senteret? Diskuter brugen af stratificeret stikpr√∏ve versus simpel tilf√¶ldig stikpr√∏ve.

3.  Hvordan kunne man i praksis udtr√¶kke stikpr√∏ven? Hvilke bias ville I v√¶re s√¶rligt bekymrede for?

---

## Case 2: Social integration i bygder og byer

**Case**: En unders√∏gelse skal vurdere graden af social integration i Gr√∏nland, b√•de i st√∏rre byer og bygder. Man vil gerne unders√∏ge forskelle mellem unge (18-29 √•r) og √¶ldre (30+ √•r) i deres deltagelse i sociale aktiviteter.

**Opgaver:**

1.  Hvordan vil I sikre, at b√•de bygder og byer er repr√¶senteret i stikpr√∏ven? Diskuter brugen af simpel tilf√¶ldig, stratificeret og klyngebaseret stikpr√∏ve.

2.  Hvordan kan man indsamle data p√• tv√¶rs af bygder med sproglig og teknologisk variation?

3.  Hvad betyder det for stikpr√∏ven, hvis bygderne bliver underrepr√¶senterede? Hvilke bias b√∏r man v√¶re opm√¶rksom p√•?

---

## Case 3: Oplysningskampagner om sundhed

**Case**: Sundhedsmyndighederne i Gr√∏nland har gennemf√∏rt en oplysningskampagne om fordelene ved sund kost. De √∏nsker at unders√∏ge kampagnens effekt blandt borgere i Gr√∏nland. Der er ca. 57.000 indbyggere, og man planl√¶gger at sp√∏rge 1.200 personer i hele landet.

**Opgaver:**

1.  Hvordan kan man v√¶lge en repr√¶sentativ stikpr√∏ve, der inkluderer b√•de by- og bygdebefolkningen? Diskuter styrker og svagheder ved forskellige stikpr√∏veudtr√¶k.

2.  Hvordan p√•virker det analysen, hvis de personer, der deltager i unders√∏gelsen, har st√∏rre interesse i sund kost end dem, der ikke g√∏r?

3.  Hvordan kan v√¶gtning af stikpr√∏vens data hj√¶lpe med at korrigere for sk√¶vheder i repr√¶sentationen?

4.  Hvordan kan vi m√•le, om stikpr√∏ven reelt afspejler hele Gr√∏nlands befolkning?

---

# Stikpr√∏veudtr√¶k og statistisk usikkerhed

-   P√• baggrund af en stikpr√∏ve drages konklusioner om en population (inferens). Slutningen er baseret p√• stikpr√∏vens **repr√¶sentativitet**

-   Den bedste m√•de at opn√• repr√¶sentativitet p√• er at anvende en udv√¶lgelsesmekanisme baseret p√• **tilf√¶ldighed!**

**Hvorfor virker tilf√¶ldigt udtr√¶k ift. at sikre en repr√¶sentativ stikpr√∏ve?**

-   Hver enhed i populationen har samme sandsynlighed for at blive udvalgt (undg√•r systematisk bias/sk√¶vvridning)
-   Sikrer, at stikpr√∏ven i *gennemsnit* er repr√¶sentativ for populationen.
-   Tilf√¶ldighed i stikpr√∏veudtr√¶k bygger p√• principper om lige sandsynlighed, store tals lov og den centrale gr√¶nsev√¶rdis√¶tning.

------------------------------------------------------------------------

# Stikpr√∏veudtr√¶k og statistisk usikkerhed

-   Fordi en stikpr√∏ve ikke svarer pr√¶cist den population, som den er trukket fra, vil der altid v√¶re en ***statistisk usikkerhed*** forbundet med en generalisering fra stikpr√∏ve til population (ogs√• kaldt margin of error).

-   Statistik handler bl.a. om at sige noget under usikkerhed og om at vurdere, hvor stor usikkerheden p√• ens udsagn er.

------------------------------------------------------------------------

# Stikpr√∏veudtr√¶k og statistisk usikkerhed

-   Usikkerhed opst√•r pga. ***udv√¶lgelsesmekanismen***, n√•r vi tr√¶kker en stikpr√∏ve.

-   Hvis vi f.eks. har en hat med sedler med alle navne p√• folk i Gr√∏nland (populationen), ryster hatten og lukker √∏jnene for at tr√¶kke et navn, er der usikkerhed, hver gang vi tr√¶kker, fordi vi ikke kender udfaldet. Hvis vi gentager dette 1000 gange, har vi en stikpr√∏ve p√• 1000 personer.

-   Man kalder denne proces for et ***eksperiment*** inden for statistik.

-   For at h√•ndtere usikkerhed opstiller man en matematisk sandsynlighedsmodel, som g√∏r os i stand til at regne p√• usikkerheden

------------------------------------------------------------------------

# Stikpr√∏veudtr√¶k og statistisk usikkerhed

Sandsynlighedsmodellen bygger p√• tre ting:

1)  **Udfaldsrum** $\Omega$: alle mulige udfald/v√¶rdier af eksperimentet. I terningekast er $\Omega = \{1, 2, 3, 4, 5, 6\}$

2)  **H√¶ndelser**: samlinger af udfald. En h√¶ndelse $A$ kunne f.eks. v√¶re at terningen viser et ulige antal √∏jne. S√• vil h√¶ndelse $A = \{1, 3, 5\}$

3)  **Sandsynlighedsm√•l**: hvis alle elementer i en population har lige stor chance for udv√¶lgelse, s√• er sandsynligheden for et udfald $z$ lig med v√¶rdien af andelsfunktionen evalueret i $z$:

    $$ P(z) = g(z) = \frac{\text{antal elementer med v√¶rdien } z \text{ i populationen}}{N_{\text{pop}}} $$

------------------------------------------------------------------------

# Stikpr√∏veudtr√¶k og statistisk usikkerhed

-   I ‚Äùeksperimenter‚Äù kender vi ikke udfaldet/v√¶rdien p√• den variabel, som vi er ved at tr√¶kke. En variabel som endnu ikke har haft et udfald, og som derfor har tilknyttet usikkerhed, kaldes en ***stokastisk variabel***.

-   En stokastisk variabel $X$ er en funktion, som til ethvert udfald af et eksperiment forbinder en talv√¶rdi fra udfaldsrummet: $ùëã(ùë¢ùëëùëìùëéùëôùëë)=ùë°ùëéùëô (\text{ùëìùëüùëé ùë¢ùëëùëìùëéùëôùëëùë†ùëüùë¢ùëöùëöùëíùë°})$

-   Stokastiske variable repr√¶senterer udfald af et eksperiment.

------------------------------------------------------------------------

# Stikpr√∏veudtr√¶k og statistisk usikkerhed

Stokastiske variable kan v√¶re enten diskrete eller kontinuerte. Dette har betydning for, hvordan vi tilskriver sandsynlighed til deres v√¶rdier.

-   **Diskrete variable:** ting som man kan t√¶lle. F.eks. Antal √∏jne p√• en terning eller antal varer solgt i en butik

-   **Kontinuerte variable:** variabler med uendeligt mange udfald inden for en given range. F.eks. Vandm√¶ngden i en vandflaske eller produktionstid for en vare. Begge tilf√¶lde kan have uendeligt mange decimaler.

------------------------------------------------------------------------

# Stikpr√∏veudtr√¶k og statistisk usikkerhed

Stokastiske variable har ogs√• fordelinger. Der er to s√¶rligt vigtige fordelinger, som I skal kende til:

-   **Binomial-fordelingen**: for diskrete stokastiske variable

-   **Normalfordelingen**: for kontinuerte stokastiske variable

------------------------------------------------------------------------

# Binomial-fordeling

-   Man bruger binomialfordelingen, n√•r man gentager et fors√∏g, der kun har to udfald (Bernoulli-fors√∏g). I statistik kaldes disse som regel succes og fiasko. Succes kan b√•de defineres som f.eks. at sl√• ‚Äùkrone‚Äù i plat og krone, men ogs√• bare som at observere en s√¶rlig v√¶rdi, f.eks. ‚Äùkvinde‚Äù i en population.

-   Forestil dig, at du 1000 gange tr√¶kker en tilf√¶ldig person fra den gr√∏nlandske population, og √∏nsker at vide sandsynligheden for at tr√¶kke en kvinde. Binomialfordelingen kan hj√¶lpe med at beregne dette.

![](images/platkrone.png){width="50%"}

------------------------------------------------------------------------

# Binomial-fordeling

-   Vi bruger binomialfordelingen, n√•r vi arbejder med andele. Hvis alle enheder i populationen har lige stor chance for udv√¶lgelse, s√• er sandsynligheden for udfaldet $z$ nemlig lig andelen af enheder i populationen med v√¶rdi $z$:

$$
P(z) = \frac{\text{antal enheder i population med v√¶rdien } z \text{ i populationen}}{N_{\text{pop}}}
$$

-   N√•r vi skal udregne statistisk usikkerhed forbundet med andele af f.eks. kvinder i vores stikpr√∏ve, g√∏r vi det alts√• p√• baggrund af sandsynligheden for at tr√¶kke en kvinde, n√•r vi tr√¶kker vores stikpr√∏ve fra populationen!

------------------------------------------------------------------------

# Binomial-fordeling

Middelv√¶rdi og varians for binomialfordelte variable udregnes som f√∏lgende:

<br>

$$
\text{Middelv√¶rdi: } E(Y) = n \cdot p \\
\text{Varians: } V(Y) = n \cdot p \cdot (1 - p)
$$

<br>

$Y$ angiver antal succeser blandt $n$ uafh√¶ngige udtr√¶kninger fra en population, hvor udfaldsrummet $\Omega=\text{{success, fiasko}}$ og der er konstant sandsynlighed, $ùëù$, for succes i hver udtr√¶kning.

------------------------------------------------------------------------

# Binomial-fordeling

-   Vi ved, at *middelv√¶rdi* $E(Y) = n*p$ ogs√• kan fortolkes som *andelen* af observationerne i stikpr√∏ven med den v√¶rdi, som vi har angivet som "success".

-   Hvis alle elementer i populationen har lige stor chance for udv√¶lgelse, s√• er sandsynligheden for udfaldet $z$ nemlig lig andelen af elementer i populationen med v√¶rdi $z$:

    $P(z) = \frac{\text{antal enheder i population med v√¶rdien } z \text{ i populationen}}{N_{\text{pop}}}$

-   Men vi ved ogs√•, at et stikpr√∏vegennemsnit er beh√¶ftet med en hvis usikkerhed ift. populationsgennemsnittet, fordi udv√¶lgelsesmekanismen har introduceret en vis tilf√¶ldighed. Derfor vil vi gerne kunne sige noget om, hvor stor usikkerheden er!

------------------------------------------------------------------------

# Store Tals Lov

-   Store Tals Lov siger, at n√•r stikpr√∏vest√∏rrelsen ($n$ ) bliver stor, vil gennemsnittet i stikpr√∏ven n√¶rme sig populationens sande gennemsnit, ($\mu$):\
    $$
    \frac{1}{n} \sum_{i=1}^{n} X_i \rightarrow \mu \quad \text{n√•r } n \to \infty
    $$ hvor ( $X_i$ ) er en tilf√¶ldig variabel i stikpr√∏ven, og ($\mu$) er populationsgennemsnittet.

-   **Implikation:** Store Tals Lov giver os en garanti for, at stikpr√∏vegennemsnittet bliver t√¶ttere p√• populationsgennemsnittet, efterh√•nden som stikpr√∏ven bliver st√∏rre!

-   Vi kan alts√• mindre usikkerheden p√• vores resultater ved at √∏ge stikpr√∏vest√∏rrelsen... men hvordan ved vi, hvor stor usikkerhed vores resultater faktisk er beh√¶ftet med?

------------------------------------------------------------------------

# Den centrale gr√¶nsev√¶rdis√¶tning

<br>

Den centrale gr√¶nsev√¶rdis√¶tning fort√¶ller os, at uanset hvilken fordeling hver observation fra en simpel tilf√¶ldig stikpr√∏ve f√∏lger, s√• er stikpr√∏vegennemsnittet approksimativt (‚Äùs√• godt som‚Äù) normalfordelt, n√•r bare stikpr√∏ven er tilstr√¶kkelig stor.

*(Malchow-M√∏ller & W√ºrst 2014:242)*

<br>

... s√• hvad er en normalfordeling?

------------------------------------------------------------------------

# Normalfordeling

-   Normalfordelingen er kendetegnet ved at v√¶re symmetrisk fordelt omkring middelv√¶rdi $\mu$, og dens bredde afh√¶nger af varians $\sigma^2$.

-   Kurven (t√¶thedsfunktionen) angiver sandsynligheden for at observere en given v√¶rdi.

```{r include=T, echo=F, message=F, warning=F}
library(ggplot2)

# Definer parametre for normalfordelingen
mean <- 0       # Gennemsnit
sd <- 1         # Standardafvigelse

# Opret et data frame med x-v√¶rdier og deres sandsynlighedst√¶thed
x <- seq(-4, 4, length.out = 100)  # Interval for x
y <- dnorm(x, mean, sd)            # Beregn sandsynlighedst√¶thed for normalfordelingen

# Kombiner x og y til et data frame
df <- data.frame(x, y)

# Plot normalfordelingen
(normalfordeling <- ggplot(df, aes(x = x, y = y)) +
  geom_line(color = "#003366", size = 1) +
  labs(y = "Sandsynlighedst√¶thed", x="Data") +
  theme_minimal() +
  theme(
    text = element_text(size = 16),            # General text size
    axis.title = element_text(size = 18),      # Axis title size
    axis.text = element_text(size = 14),       # Axis labels size
  ))
```

------------------------------------------------------------------------

# Normalfordeling

H√∏jde i en befolkning er typisk naturligt normaltfordelt. Her er et eksempel p√• h√∏jdefordelingen blandt en population med $\mu=170$ cm og $\sigma=10$ cm

```{r}
# Indl√¶s n√∏dvendige pakker
library(ggplot2)

# Simuler data for h√∏jde
set.seed(42)  # For reproducerbarhed
population_size <- 10000
mean_height <- 170  # Gennemsnitlig h√∏jde i cm
sd_height <- 10  # Standardafvigelse i cm

heights <- rnorm(population_size, mean = mean_height, sd = sd_height)

# Lav et datas√¶t
height_data <- data.frame(Height = heights)

# Plot den simulerede normalfordeling
ggplot(height_data, aes(x = Height)) +
  geom_histogram(aes(y = ..density..), bins = 30, color = "black", fill = "#003366", alpha = 0.7) +
  stat_function(fun = dnorm, args = list(mean = mean_height, sd = sd_height), color = "red", size = 1.2) +
  labs(
    title = "Normalfordeling af H√∏jde i Population",
    x = "H√∏jde (cm)",
    y = "Densitet"
  ) +
  theme_minimal()
```

------------------------------------------------------------------------

# Normalfordeling

Hvis vi plotter h√∏jdefordelingen blandt babyer vil den ogs√• v√¶re normalfordelt, men med et lavere gennemsnit, og en mindre standardafvigelse! Her er et eksempel p√• h√∏jdefordelingen blandt en baby-population med $\mu=50$ cm og $\sigma=5$ cm

```{r}
# Indl√¶s n√∏dvendige pakker
library(ggplot2)

# Simuler data for babyer
set.seed(1234)  # For reproducerbarhed
population_size <- 10000
mean_baby_height <- 50  # Gennemsnitlig h√∏jde for babyer i cm
sd_baby_height <- 5  # Standardafvigelse for babyer i cm

baby_heights <- rnorm(population_size, mean = mean_baby_height, sd = sd_baby_height)

# Lav et datas√¶t
height_data_babies <- data.frame(Height = baby_heights)

# Definer x-akse ticks og interval
x_limits <- c(20, 200)  # Antag intervallet for voksne og babyer
x_ticks <- seq(25, 200, by = 25)  # Ticks for hver 10 cm

# Plot den simulerede normalfordeling for babyer
ggplot(height_data_babies, aes(x = Height)) +
  geom_histogram(aes(y = ..density..), bins = 30, color = "black", fill = "#003366", alpha = 0.7) +
  stat_function(fun = dnorm, args = list(mean = mean_baby_height, sd = sd_baby_height), color = "red", size = 1.2) +
  scale_x_continuous(breaks = x_ticks, limits = x_limits) +  # Ticks for hver 10 cm og x-akse interval
  labs(
    title = "Normalfordeling af h√∏jde for babyer",
    x = "H√∏jde (cm)",
    y = "Densitet"
  ) +
  theme_minimal()
```

------------------------------------------------------------------------

# Normalfordeling

<br>

### **√òvelse**

Lad os pr√∏ve at simulere en normalfordeling med simpelt tilf√¶ldigt udtr√¶k!

------------------------------------------------------------------------

# Normalfordeling

-   Mange naturlige st√∏rrelser i virkelige populationer har en fordeling, som ligner normalfordelingen, f.eks. h√∏jde i en befolkning. Mange estimatorer og test-statistikker er normalfordelte; f.eks. stikpr√∏vegennemsnit jf. den centrale gr√¶nsev√¶rdis√¶tning

-   Hvis en stokastisk variabel $Y$ er normalfordelt $Y \sim \mathcal{N}(\mu, \sigma^2)$ s√• er det alts√• mest sandsynligt at observere v√¶rdier, der ligger t√¶t p√• gennemsnittet.

-   Faktisk er normalfordelte variable skruet s√•dan sammen, at vi ud fra standardafvigelsen p√• en variabel kan sige, hvor stor en andel af observationerne der ligger inden for et given afstand til gennemsnittet.

-   Derfor kan man bruge standardafvigelsen fra en normalfordeling til at fastl√¶gge et acceptabelt niveau af usikkerhed, og estimere usikkerheden p√• sine stikpr√∏veberegninger!

------------------------------------------------------------------------

# Normalfordeling

-   Hele arealet under en normalfordelingskurve svarer til 100 % sandsynlighed (eller 1 i decimaltal). Dette betyder, at alle observationer i populationen er inkluderet i kurven.
-   Arealet mellem to v√¶rdier p√• x-aksen (f.eks. mellem -1 og +1 standardafvigelser fra gennemsnittet) angiver sandsynligheden for, at en observation falder inden for dette interval.

```{r}
# Indl√¶s n√∏dvendige pakker
library(ggplot2)

# Simuler data for h√∏jde
set.seed(42)  # For reproducerbarhed
population_size <- 10000
mean_height <- 170  # Gennemsnitlig h√∏jde i cm
sd_height <- 10  # Standardafvigelse i cm

heights <- rnorm(population_size, mean = mean_height, sd = sd_height)

# Lav et datas√¶t
height_data <- data.frame(Height = heights)

# Plot den simulerede normalfordeling
ggplot(height_data, aes(x = Height)) +
  geom_histogram(aes(y = ..density..), bins = 30, color = "black", fill = "#003366", alpha = 0.7) +
  stat_function(fun = dnorm, args = list(mean = mean_height, sd = sd_height), color = "red", size = 1.2) +
  labs(
    title = "Normalfordeling af h√∏jde i en population",
    x = "H√∏jde (cm)",
    y = "Densitet"
  ) +
  theme_minimal()
```

------------------------------------------------------------------------

# Normalfordelingen og statistisk usikkerhed

Hvis en variabel er normalfordelt s√• ligger omkring‚Ä¶

-   68 % af observationerne i intervallet +/- 1 standardafvigelse fra middelv√¶rdien

-   95 % af observationerne i intervallet +/- 2 standardafvigelse fra middelv√¶rdien

-   99,7 % af observationerne i intervallet +/- 3 standardafvigelse fra middelv√¶rdien

------------------------------------------------------------------------

# Standardnormalfordeling

I praksis bruger man en s√¶rlig normalfordeling, nemlig ***standardnormalfordelingen***.

Hvorfor? Det er nemmest at tage udgangspunkt i en standardiseret udgave af normalfordelingen. Standardnormalfordelingen er en normalfordeling med et gennemsnit $\mu=0$ og en standardafvigelse $\sigma=1$

```{r}

# Load ggplot2 and grid (for arrows)
library(ggplot2)
library(grid)

# Parameters for the standard normal distribution
mean <- 0       # Mean (mu)
sd <- 1         # Standard deviation (sigma)

# Create a data frame with x values and their density for the normal distribution
x <- seq(-4, 4, length.out = 100)  # x-range
y <- dnorm(x, mean, sd)            # Density of the normal distribution
df <- data.frame(x, y)

# Plot the standard normal distribution
ggplot(df, aes(x = x, y = y)) +
  geom_line(color = "#003366", size = 1) +
  labs(y = "Sandsynlighedst√¶thed", x="Data") +
  theme_minimal() +
  
  # Add text for the mean and standard deviations, slightly shifted to the sides
  annotate("text", x = mean, y = max(y) + 0.02, label = expression(mu), size = 5, color = "black") +
  annotate("text", x = -1.3, y = dnorm(-1, mean, sd) + 0.02, label = expression(-sigma), size = 4, color = "black") +
  annotate("text", x = 1.3, y = dnorm(1, mean, sd) + 0.02, label = expression(sigma), size = 4, color = "black") +
  
  # Add a horizontal arrow between -sigma and +sigma, placed near the sd markers
  geom_segment(aes(x = -0.9, xend = .9, y = dnorm(1, mean, sd) + 0.01, yend = dnorm(1, mean, sd) + 0.01), 
               arrow = arrow(ends = "both", type = "closed", length = unit(0.2, "cm")), color = "black") +
annotate("text", x = 0, y = dnorm(1, mean, sd) + 0.03, label = "¬± œÉ", size = 4, color = "black")+
    theme(
    text = element_text(size = 16),            # General text size
    axis.title = element_text(size = 18),      # Axis title size
    axis.text = element_text(size = 14)      # Axis labels size
  )
```

------------------------------------------------------------------------

# Standardnormalfordeling

I standardnormalfordelingen ligger...

-   90 % af observationerne i intervallet ¬±1,645 standardafvigelser fra middelv√¶rdien

-   95 % af observationerne i intervallet ¬±1,96 standardafvigelser fra middelv√¶rdien

-   99 % af observationerne i intervallet ¬±2,576 standardafvigelser fra middelv√¶rdien

------------------------------------------------------------------------

# Estimation i stikpr√∏ver

N√•r vi ikke har adgang til fuld population kan vi alts√• bruge stikpr√∏ver til at estimere, hvordan fordelinger ser ud i populationen:

-   $\mu$: populationsgennemsnittet (det sande gennemsnit for hele populationen).

-   $\bar{X}$: stikpr√∏vegennemsnittet (gennemsnittet beregnet ud fra en stikpr√∏ve, som bruges som et sk√∏n for populationsgennemsnittet $\mu$).

-   $s$: stikpr√∏vens standardafvigelse (bruges som estimat for $\sigma$, populationens standardafvigelse)

-   N√•r stikpr√∏ven er stor og repr√¶sentativ, kan vi antage at: $\bar{X} \approx \mu$

Dog m√• vi leve med, at der altid er en hvis usikkerhed forbundet med stikpr√∏vegennemsnittet... til geng√¶ld kan vi bruge vores viden om normalfordelingen til at regne p√• den!

------------------------------------------------------------------------

# Konfidensintervaller

-   For at give et bud p√• den usikkerhed, der er forbundet med de beregninger vi laver p√• stikpr√∏ver, kan vi udregne konfidensintervaller

-   Konfidensintervallet estimerer med en vis (u)sikkerhed indenfor hvilket interval populationens v√¶rdi ligger. I stedet for kun at angive et punkt-estimat (en andel eller et gennemsnittet), angiver man alts√• et interval inden for hvilket, man forventer at andelen/ gennemsnittet i populationen ligger.

------------------------------------------------------------------------

# Konfidensintervaller

-   Ved hj√¶lp af den standardnormalfordelingen kan vi beregne, hvor sandsynligt det er, at populationsgennemsnittet ligger i et bestemt interval omkring stikpr√∏vegennemsnittet. Det er meget almindeligt at konstruere 95% konfidensintervaller.

-   Princippet er, at man s√• udregner et interval, hvor vi populationens v√¶rdi med 95 % sikkerhed ligger indenfor. For en normalfordeling svarer dette til $\pm 1,96$ standardafvigelser omkring stikpr√∏vegennemsnittet.

------------------------------------------------------------------------

# Konfidensintervaller

![](images/standardnormalfordeling.png){fig-align="center"}

------------------------------------------------------------------------

# Stikpr√∏veusikkerhed: intervalskala

$$
u = 1,96 \cdot \frac{s}{\sqrt{n}}
$$

-   $u$ = den statistiske usikkerhed

-   $s$ = standardafvigelsen

-   $n$ = antal individer i stikpr√∏ven

-   $\frac{s}{\sqrt{n}}$ = standardfejlen (standard error ‚Äì beregnes p√• baggrund af standardafvigelsen)

------------------------------------------------------------------------

# Stikpr√∏veusikkerhed: nominal og ordinal skala

$$
u = 1,96 \cdot \frac{p \cdot q}{n}
$$

-   $u$ = den statistiske usikkerhed\
-   $p$ = andel i den kategori vi gerne vil sige noget om\
-   $q$ = andel i variablens resterende kategorier\
-   $n$ = antal individer i stikpr√∏ven
-   $\frac{p \cdot q}{n}$ = standardfejlen (standard error ‚Äì beregnes p√• baggrund af fordelingerne)

------------------------------------------------------------------------

# Konfidensintervaller: intervalskala

Formlen for beregningen af konfidensinterval ved gennemsnit:

$$
\text{Intervallets nedre gr√¶nse} = \bar{X} - z \cdot \frac{s}{\sqrt{n}}
$$

$$
\text{Intervallets √∏vre gr√¶nse} = \bar{X} + z \cdot \frac{s}{\sqrt{n}}
$$

-   Hvor $\frac{\sigma}{\sqrt{n}}$ standardfejlen (Standard error).

-   $\bar{X} =$ gennemsnit i stikpr√∏ven

-   $z =$ antallet af valgte standardafvigelser, ofte $z = 1,96$ (svarende til $95%$ %)

-   $s =$ standardafvigelse i stikpr√∏ven

-   $n =$ antallet af observationer i stikpr√∏ven (stikpr√∏vest√∏rrelsen)

------------------------------------------------------------------------

# Konfidensintervaller: nominal- og ordinalskala

Formlen for beregningen af konfidensinterval ved andele:

$$
\text{Intervallets nedre gr√¶nse} = p - z \cdot \sqrt{\frac{p(1-p)}{n}}
$$

$$
\text{Intervallets √∏vre gr√¶nse} = p + z \cdot \sqrt{\frac{p(1-p)}{n}}
$$

-   Hvor: $\sqrt{\frac{p(1-p)}{n}}$ er standardfejlen (Standard error).

-   $p =$ andelen i stikpr√∏ven (fx $0,3$ eller $0,25$)

-   $z=$ antallet af valgte standardafvigelser, ofte $z=1,96$ (svarende til $95%$ %)

-   $n =$ antallet af observationer i stikpr√∏ven (stikpr√∏vest√∏rrelsen)

---

# Eks. Konfidensintervaller: nominal- og ordinalskala

$$
stikpr√∏vegennemsnit/andel = \bar{x}=0,3
$$
$$
n = 10
$$

$$
\text{Intervallets nedre gr√¶nse} = 0,3 - 1,96 \cdot \sqrt{\frac{0,3(1-0,3)}{10}}=0,3-0,284=0.016
$$

$$
\text{Intervallets √∏vre gr√¶nse} = 0,3 + 1,96 \cdot \sqrt{\frac{0,3(1-0,3)}{10}}=0,3+0,284=0.584
$$

------------------------------------------------------------------------

# Standardfejl

Standardfejl m√•ler, hvor meget en stikpr√∏veestimator (f.eks. gennemsnit) typisk vil variere fra stikpr√∏ve til stikpr√∏ve, hvis vi gentager m√•lingen flere gange:

$SE = \frac{s}{\sqrt{n}}$\

-   $s$ er stikpr√∏vens standardafvigelse (bruges som estimat for $\sigma$, populationens standardafvigelse).

-   $n$ er stikpr√∏vest√∏rrelsen.

Standardfejlen angiver usikkerheden p√• stikpr√∏vegennemsnittet og viser, hvor t√¶t stikpr√∏vegennemsnittet forventes at v√¶re p√• populationsgennemsnittet ($\mu$).

En st√∏rre stikpr√∏ve ($n$) giver en mindre standardfejl, fordi st√∏rre stikpr√∏ver er mere pr√¶cise.

------------------------------------------------------------------------

# Statistisk usikkerhed og stikpr√∏vest√∏rrelse

Hvor statistisk sikker er en stikpr√∏ve?

-   Stikpr√∏ven absolutte st√∏rrelse: jo flere observationer desto bedre

-   Stikpr√∏vens st√∏rrelse ift. universets st√∏rrelse (udtr√¶k med tilbagel√¶gning?)

-   Variationen i universet

------------------------------------------------------------------------

# Statistisk usikkerhed og stikpr√∏vest√∏rrelse

Stikpr√∏vens usikkerhed som funktion af stikpr√∏vens st√∏rrelse:

::: table-slide
| n | 1/99% | 2/98% | 5/95% | 10/90% | 15/85% | 20/80% | 25/75% | 30/70% | 35/65% | 40/60% | 45/55% | 50/50% |
|------|------|------|------|------|------|------|------|------|------|------|------|------|
| 50 | 2,8% | 3,9% | 6,0% | 8,3% | 9,9% | 11,1% | 12,0% | 12,7% | 13,2% | 13,6% | 13,8% | 13,9% |
| 100 | 2,0% | 2,7% | 4,3% | 5,9% | 7,0% | 7,8% | 8,5% | 9,0% | 9,3% | 9,6% | 9,8% | 9,8% |
| 250 | 1,2% | 1,7% | 2,7% | 3,7% | 4,4% | 5,0% | 5,4% | 5,7% | 5,9% | 6,1% | 6,2% | 6,2% |
| 500 | 0,9% | 1,2% | 1,9% | 2,6% | 3,1% | 3,5% | 3,8% | 4,0% | 4,2% | 4,3% | 4,4% | 4,4% |
| 750 | 0,7% | 1,0% | 1,6% | 2,1% | 2,6% | 2,9% | 3,1% | 3,3% | 3,4% | 3,5% | 3,6% | 3,6% |
| 1.000 | 0,6% | 0,9% | 1,4% | 1,9% | 2,2% | 2,5% | 2,7% | 2,8% | 3,0% | 3,0% | 3,1% | 3,1% |
| 1.500 | 0,5% | 0,7% | 1,1% | 1,5% | 1,8% | 2,0% | 2,2% | 2,3% | 2,4% | 2,5% | 2,5% | 2,5% |
| 2.000 | 0,4% | 0,6% | 1,0% | 1,3% | 1,6% | 1,8% | 1,9% | 2,0% | 2,1% | 2,1% | 2,2% | 2,2% |
| 5.000 | 0,3% | 0,4% | 0,6% | 0,8% | 1,0% | 1,1% | 1,2% | 1,3% | 1,3% | 1,3% | 1,4% | 1,4% |
| 10.000 | 0,2% | 0,3% | 0,4% | 0,6% | 0,7% | 0,8% | 0,8% | 0,9% | 0,9% | 1,0% | 1,0% | 1,0% |
:::

------------------------------------------------------------------------

# Statistisk usikkerhed og stikpr√∏vest√∏rrelse

Eksempel med 50/50 fordeling (h√∏j variation)

```{r}
# Load ggplot2 for plotting
library(ggplot2)

# Data from the table (sample sizes and uncertainty for 50/50 distribution)
data <- data.frame(
  N = c(50, 100, 250, 500, 750, 1000, 1500, 2000, 5000, 10000),
  Uncertainty = c(13.9, 9.8, 6.2, 4.4, 3.6, 3.1, 2.5, 2.2, 1.4, 1.0)
)

# Create line graph
ggplot(data, aes(x = N, y = Uncertainty)) +
  geom_line(color = "#003366", size = 1) +
  scale_x_continuous(breaks = seq(0, 10000, by = 1000)) +  # Adds ticks every 500 units
  scale_y_continuous(breaks = seq(0, 15, by = 1)) +  # Adds ticks every 500 units
  labs(
    x = "Stikpr√∏vest√∏rrelse (N)",
    y = "Usikkerhed (%)"
  ) +
  theme_minimal() +
   theme(
    axis.title = element_text(size = 14),  # Increase axis titles font size
    axis.text = element_text(size = 12)    # Increase axis labels font size
  )
```

------------------------------------------------------------------------

# Statistisk usikkerhed og stikpr√∏vest√∏rrelse

Eksempel med 1/99 fordeling (lav variation)

```{r}
# Data from the table (sample sizes and uncertainty for 1/99 distribution)
data <- data.frame(
  N = c(50, 100, 250, 500, 750, 1000, 1500, 2000, 5000, 10000),
  Uncertainty = c(2.8, 2.0, 1.2, 0.9, 0.7, 0.6, 0.5, 0.4, 0.3, 0.2)
)

# Create line graph for 1/99 distribution
ggplot(data, aes(x = N, y = Uncertainty)) +
  geom_line(color = "#003366", size = 1) +
  scale_x_continuous(breaks = seq(0, 10000, by = 1000)) +
  scale_y_continuous(breaks = seq(0, 3, by = 0.5)) +
  labs(
    x = "Stikpr√∏vest√∏rrelse (N)",
    y = "Usikkerhed (%)") +
  theme_minimal() +
  theme(
    axis.title = element_text(size = 14),
    axis.text = element_text(size = 12)
  )
```

------------------------------------------------------------------------

# Repr√¶sentativitet og bortfald

En repr√¶sentativ stikpr√∏ve er en stikpr√∏ve, som *repr√¶senterer* den population, som den er trukket fra p√• v√¶sentlige karakteristka. Repr√¶sentativitet afh√¶nger dels af:

<br>

-   Udv√¶lgelsesmekanismen (hvordan man tr√¶kker sin stikpr√∏ve)

-   Sk√¶vhed i stikpr√∏ven (sampling bias)

    -   Tilf√¶ldig sk√¶vhed (som udgangspunkt uproblematisk)

    -   Systematisk sk√¶vhed: der er systematik i, hvem der svarer, og hvem der ikke g√∏r (problematisk!)

------------------------------------------------------------------------

# Repr√¶sentativitet og bortfald

## ![](images/studiepopulation.png)

------------------------------------------------------------------------

# Repr√¶sentativitet og bortfald

**Eks.**

*Hvilken form for sk√¶vhed ville vi forvente, hvis vi udsendte en survey blandt en stikpr√∏ve af borgere i Gr√∏nland (simpelt tilf√¶ldigt udtrukket), men kun gjorde vores survey tilg√¶ngelig p√• dansk?*

------------------------------------------------------------------------

# Repr√¶sentativitet og bortfald

Bortfald er vigtigt, fordi det er p√•virker vores unders√∏gelses eksterne validitet:

-   **Ekstern validitet:** Refererer til *generaliserbarheden* af resultaterne.

<br>

Sp√∏rg dig selv: Kan du generalisere p√• dine resultater fra stikpr√∏ven til den population, som stikpr√∏ven kommer fra? Er populationen repr√¶senteret i tilstr√¶kkelig grad i stikpr√∏ven? Det var jo hele pointen bag stikpr√∏ven i f√∏rste omgang!

------------------------------------------------------------------------

# Repr√¶sentativitet og bortfald

Man kan finde ud af, om ens stikpr√∏ve er repr√¶sentativ for populationen ved at sammenligne fordelinger p√• vigtige variable fra hhv. population og stikpr√∏ve og evt. v√¶gte underrepr√¶senterede grupper op:

::: table-slide
| K√∏n | Alder (√•r) | Univers (antal) | Univers (pct.) | Stikpr√∏ve (antal) | Stikpr√∏ve (pct.) | V√¶gt |
|-----------|-----------|-----------|-----------|-----------|-----------|-----------|
| M√¶nd | 15-40 | 874.044 | 19,8 | 165 | 13,3 | 19,8/13,3=**1,49** |
| M√¶nd | 40-69 | 1.057.619 | 24,0 | 368 | 29,6 | 24/29,6=**0,81** |
| M√¶nd | 70+ | 233.798 | 5,3 | 77 | 6,2 | 5,3/6,2=**0,86** |
| Kvinder | 15-40 | 851.737 | 19,3 | 179 | 14,4 | 19,3/14,4=**1,34** |
| Kvinder | 40-69 | 1.053.420 | 23,9 | 359 | 28,9 | 23,9/28,9=**0,83** |
| Kvinder | 70+ | 340.962 | 7,7 | 96 | 7,7 | 7,7/7,7=**1** |
| **Total** |  | **4.411.580** | **100** | **1.244** | **100** |  |
:::

*Obs: her antages det, at der er tilf√¶ldigt bortfald! Ellers v√¶gter man bare sk√¶vheden yderligere op.*

------------------------------------------------------------------------

# Niveauer

::: table-slide
| Begreb | Definition |
|---------------------------------------------|---------------------------|
| **Universet/populationen** | M√•lgruppe, hvori en stikpr√∏ve udtr√¶kkes (fx alle statsborgere i Danmark). |
| **Den mulige population** | Del af universet, som kan udtr√¶kkes til stikpr√∏ven. |
| **Stikpr√∏ve/sample** | Lille del af universet, udvalgt til at repr√¶sentere hele universet. |
| **Respondenter/besvarelser** | Del af stikpr√∏ven, der deltager i surveyen (svarprocent). |
:::

------------------------------------------------------------------------

## Opsamling: populationer og stikpr√∏ver

-   **Population og stikpr√∏ve**:
    -   En population er den gruppe, vi √∏nsker at unders√∏ge.
    -   En stikpr√∏ve er en repr√¶sentativ del af populationen, som bruges til at drage konklusioner om populationen.

<br>

-   **Repr√¶sentativitet og bortfald**:
    -   En stikpr√∏ve skal v√¶re repr√¶sentativ for populationen for at give gyldige resultater.
    -   Tilf√¶ldig sk√¶vhed kan tolereres, men systematisk sk√¶vhed p√•virker resultaterne negativt.

------------------------------------------------------------------------

## Opsamling: populationer og stikpr√∏ver

-   **Statistisk usikkerhed og sandsynlighed**:
    -   Usikkerhed er altid til stede, n√•r vi bruger stikpr√∏ver.
    -   Store tals lov og den centrale gr√¶nsev√¶rdis√¶tning sikrer, at stikpr√∏vegennemsnit er p√•lidelige estimater af populationsgennemsnit for store stikpr√∏ver.

<br>

-   **Binomial- og normalfordeling**:
    -   Binomialfordelingen bruges til diskrete sandsynligheder (to udfald).
    -   Normalfordelingen bruges til kontinuerte variabler og er grundlaget for beregning af konfidensintervaller.

------------------------------------------------------------------------

## Opsamling: populationer og stikpr√∏ver

-   **Konfidensintervaller**:
    -   Bruges til at give et interval omkring stikpr√∏vegennemsnittet, hvor vi med h√∏j sandsynlighed forventer, at populationsgennemsnittet ligger.

<br>

-   **Stikpr√∏vest√∏rrelse og variation**:
    -   Jo st√∏rre stikpr√∏ven er, jo lavere usikkerhed.
    -   Variation i populationen p√•virker, hvor pr√¶cis vores stikpr√∏ve kan v√¶re med en given st√∏rrelse.
