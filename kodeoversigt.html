<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Mikkeline Munk Nielsen">

<title>Kodeoversigt</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="kodeoversigt_files/libs/clipboard/clipboard.min.js"></script>
<script src="kodeoversigt_files/libs/quarto-html/quarto.js"></script>
<script src="kodeoversigt_files/libs/quarto-html/popper.min.js"></script>
<script src="kodeoversigt_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="kodeoversigt_files/libs/quarto-html/anchor.min.js"></script>
<link href="kodeoversigt_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="kodeoversigt_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="kodeoversigt_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="kodeoversigt_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="kodeoversigt_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="custom-toc.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduktion" id="toc-introduktion" class="nav-link active" data-scroll-target="#introduktion">Introduktion</a></li>
  <li><a href="#objekter" id="toc-objekter" class="nav-link" data-scroll-target="#objekter">Objekter</a></li>
  <li><a href="#pakker" id="toc-pakker" class="nav-link" data-scroll-target="#pakker">Pakker</a>
  <ul>
  <li><a href="#installér-pakker" id="toc-installér-pakker" class="nav-link" data-scroll-target="#installér-pakker">Installér pakker</a></li>
  <li><a href="#indlæs-pakker" id="toc-indlæs-pakker" class="nav-link" data-scroll-target="#indlæs-pakker">Indlæs pakker</a></li>
  </ul></li>
  <li><a href="#datasæt" id="toc-datasæt" class="nav-link" data-scroll-target="#datasæt">Datasæt</a>
  <ul>
  <li><a href="#indlæs-datasæt" id="toc-indlæs-datasæt" class="nav-link" data-scroll-target="#indlæs-datasæt">Indlæs datasæt</a>
  <ul class="collapse">
  <li><a href="#eksempel" id="toc-eksempel" class="nav-link" data-scroll-target="#eksempel">Eksempel</a></li>
  </ul></li>
  <li><a href="#åben-dataset" id="toc-åben-dataset" class="nav-link" data-scroll-target="#åben-dataset">Åben dataset</a></li>
  </ul></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling">Data wrangling</a>
  <ul>
  <li><a href="#omdøbe-variable" id="toc-omdøbe-variable" class="nav-link" data-scroll-target="#omdøbe-variable">Omdøbe variable</a></li>
  <li><a href="#omkodning-af-variable" id="toc-omkodning-af-variable" class="nav-link" data-scroll-target="#omkodning-af-variable">Omkodning af variable</a>
  <ul class="collapse">
  <li><a href="#eksempler-med-european-social-survey" id="toc-eksempler-med-european-social-survey" class="nav-link" data-scroll-target="#eksempler-med-european-social-survey">Eksempler med European Social Survey</a></li>
  </ul></li>
  <li><a href="#subsetting" id="toc-subsetting" class="nav-link" data-scroll-target="#subsetting">Subsetting</a></li>
  <li><a href="#gruppering-af-data" id="toc-gruppering-af-data" class="nav-link" data-scroll-target="#gruppering-af-data">Gruppering af data</a></li>
  <li><a href="#dummy-variable" id="toc-dummy-variable" class="nav-link" data-scroll-target="#dummy-variable">Dummy-variable</a></li>
  </ul></li>
  <li><a href="#ggplot" id="toc-ggplot" class="nav-link" data-scroll-target="#ggplot">ggplot</a>
  <ul>
  <li><a href="#de-tre-grundelementer-i-ggplot2" id="toc-de-tre-grundelementer-i-ggplot2" class="nav-link" data-scroll-target="#de-tre-grundelementer-i-ggplot2">De tre grundelementer i ggplot2</a></li>
  <li><a href="#typer-af-plots" id="toc-typer-af-plots" class="nav-link" data-scroll-target="#typer-af-plots">Typer af plots</a>
  <ul class="collapse">
  <li><a href="#barplot-univariat" id="toc-barplot-univariat" class="nav-link" data-scroll-target="#barplot-univariat">Barplot (univariat)</a></li>
  <li><a href="#histogram-univariat" id="toc-histogram-univariat" class="nav-link" data-scroll-target="#histogram-univariat">Histogram (univariat)</a></li>
  <li><a href="#boksplot-univariat" id="toc-boksplot-univariat" class="nav-link" data-scroll-target="#boksplot-univariat">Boksplot (univariat)</a></li>
  <li><a href="#barplot-bivariat" id="toc-barplot-bivariat" class="nav-link" data-scroll-target="#barplot-bivariat">Barplot (bivariat)</a></li>
  <li><a href="#jitter-plot-bivariat" id="toc-jitter-plot-bivariat" class="nav-link" data-scroll-target="#jitter-plot-bivariat">Jitter-plot (bivariat)</a></li>
  <li><a href="#boksplot-bivariat" id="toc-boksplot-bivariat" class="nav-link" data-scroll-target="#boksplot-bivariat">Boksplot (bivariat)</a></li>
  <li><a href="#scatterplot-bivariat" id="toc-scatterplot-bivariat" class="nav-link" data-scroll-target="#scatterplot-bivariat">Scatterplot (bivariat)</a></li>
  <li><a href="#scatterplot-bivariat-med-regressionslinje" id="toc-scatterplot-bivariat-med-regressionslinje" class="nav-link" data-scroll-target="#scatterplot-bivariat-med-regressionslinje">Scatterplot (bivariat) med regressionslinje</a></li>
  </ul></li>
  <li><a href="#ændring-af-plot-udseende" id="toc-ændring-af-plot-udseende" class="nav-link" data-scroll-target="#ændring-af-plot-udseende">Ændring af plot-udseende</a></li>
  <li><a href="#gem-dit-ggplot" id="toc-gem-dit-ggplot" class="nav-link" data-scroll-target="#gem-dit-ggplot">Gem dit ggplot</a></li>
  </ul></li>
  <li><a href="#tabeller" id="toc-tabeller" class="nav-link" data-scroll-target="#tabeller">Tabeller</a>
  <ul>
  <li><a href="#envejstabeller" id="toc-envejstabeller" class="nav-link" data-scroll-target="#envejstabeller">Envejstabeller</a></li>
  <li><a href="#tovejstabellerkrydstabeller" id="toc-tovejstabellerkrydstabeller" class="nav-link" data-scroll-target="#tovejstabellerkrydstabeller">Tovejstabeller/krydstabeller</a></li>
  <li><a href="#gem-din-tabel-som-excel-fil" id="toc-gem-din-tabel-som-excel-fil" class="nav-link" data-scroll-target="#gem-din-tabel-som-excel-fil">Gem din tabel som excel-fil</a></li>
  </ul></li>
  <li><a href="#univariat-analyse" id="toc-univariat-analyse" class="nav-link" data-scroll-target="#univariat-analyse">Univariat analyse</a>
  <ul>
  <li><a href="#centrummål" id="toc-centrummål" class="nav-link" data-scroll-target="#centrummål">Centrummål</a>
  <ul class="collapse">
  <li><a href="#typetalmodus" id="toc-typetalmodus" class="nav-link" data-scroll-target="#typetalmodus">Typetal/modus</a></li>
  <li><a href="#gennemsnitmiddelværdi" id="toc-gennemsnitmiddelværdi" class="nav-link" data-scroll-target="#gennemsnitmiddelværdi">Gennemsnit/middelværdi</a></li>
  <li><a href="#median" id="toc-median" class="nav-link" data-scroll-target="#median">Median</a></li>
  </ul></li>
  <li><a href="#fraktiler" id="toc-fraktiler" class="nav-link" data-scroll-target="#fraktiler">Fraktiler</a>
  <ul class="collapse">
  <li><a href="#all-in-one-summary" id="toc-all-in-one-summary" class="nav-link" data-scroll-target="#all-in-one-summary">All-in-one summary</a></li>
  </ul></li>
  <li><a href="#spredningsmål" id="toc-spredningsmål" class="nav-link" data-scroll-target="#spredningsmål">Spredningsmål</a></li>
  <li><a href="#konfidensintervaller" id="toc-konfidensintervaller" class="nav-link" data-scroll-target="#konfidensintervaller">Konfidensintervaller</a></li>
  <li><a href="#t-test-for-univariat-analyse" id="toc-t-test-for-univariat-analyse" class="nav-link" data-scroll-target="#t-test-for-univariat-analyse">T-test for univariat analyse</a></li>
  <li><a href="#chi2-test-for-univariat-analyse-goodness-of-fit" id="toc-chi2-test-for-univariat-analyse-goodness-of-fit" class="nav-link" data-scroll-target="#chi2-test-for-univariat-analyse-goodness-of-fit"><span class="math inline">\(\chi^2\)</span>-test for univariat analyse (goodness of fit)</a></li>
  </ul></li>
  <li><a href="#bivariat-analyse" id="toc-bivariat-analyse" class="nav-link" data-scroll-target="#bivariat-analyse">Bivariat analyse</a>
  <ul>
  <li><a href="#korrelationskoefficienter" id="toc-korrelationskoefficienter" class="nav-link" data-scroll-target="#korrelationskoefficienter">Korrelationskoefficienter</a>
  <ul class="collapse">
  <li><a href="#cramers-v" id="toc-cramers-v" class="nav-link" data-scroll-target="#cramers-v">Cramers v</a></li>
  <li><a href="#spearmans-rho" id="toc-spearmans-rho" class="nav-link" data-scroll-target="#spearmans-rho">Spearman’s rho</a></li>
  <li><a href="#pearsons-r" id="toc-pearsons-r" class="nav-link" data-scroll-target="#pearsons-r">Pearsons r</a></li>
  </ul></li>
  <li><a href="#t-test-for-forskelle-på-to-gennemsnit" id="toc-t-test-for-forskelle-på-to-gennemsnit" class="nav-link" data-scroll-target="#t-test-for-forskelle-på-to-gennemsnit">T-test for forskelle på to gennemsnit</a></li>
  <li><a href="#chi2-test-for-uafhængighed" id="toc-chi2-test-for-uafhængighed" class="nav-link" data-scroll-target="#chi2-test-for-uafhængighed"><span class="math inline">\(\chi^2\)</span>-test for uafhængighed</a></li>
  </ul></li>
  <li><a href="#multivariat-analyse-lineær-regression" id="toc-multivariat-analyse-lineær-regression" class="nav-link" data-scroll-target="#multivariat-analyse-lineær-regression">Multivariat analyse (lineær regression)</a>
  <ul>
  <li><a href="#installér-texreg" id="toc-installér-texreg" class="nav-link" data-scroll-target="#installér-texreg">Installér <code>texreg</code></a></li>
  <li><a href="#estimation-af-en-regressionsmodel-i-r" id="toc-estimation-af-en-regressionsmodel-i-r" class="nav-link" data-scroll-target="#estimation-af-en-regressionsmodel-i-r">Estimation af en regressionsmodel i R</a></li>
  <li><a href="#simpel-model" id="toc-simpel-model" class="nav-link" data-scroll-target="#simpel-model">Simpel model</a></li>
  <li><a href="#multipel-model" id="toc-multipel-model" class="nav-link" data-scroll-target="#multipel-model">Multipel model</a></li>
  <li><a href="#forlæns-modelsøgning" id="toc-forlæns-modelsøgning" class="nav-link" data-scroll-target="#forlæns-modelsøgning">Forlæns modelsøgning</a></li>
  <li><a href="#labels-på-regressionstabeller" id="toc-labels-på-regressionstabeller" class="nav-link" data-scroll-target="#labels-på-regressionstabeller">Labels på regressionstabeller</a></li>
  <li><a href="#eksportér-regressionsmodeller" id="toc-eksportér-regressionsmodeller" class="nav-link" data-scroll-target="#eksportér-regressionsmodeller">Eksportér regressionsmodeller</a></li>
  <li><a href="#forudsagte-værdier" id="toc-forudsagte-værdier" class="nav-link" data-scroll-target="#forudsagte-værdier">Forudsagte værdier</a></li>
  <li><a href="#f-test-mellem-to-modeller" id="toc-f-test-mellem-to-modeller" class="nav-link" data-scroll-target="#f-test-mellem-to-modeller">F-test mellem to modeller</a></li>
  <li><a href="#heteroskedasticitet" id="toc-heteroskedasticitet" class="nav-link" data-scroll-target="#heteroskedasticitet">Heteroskedasticitet</a>
  <ul class="collapse">
  <li><a href="#grafisk-inspektion" id="toc-grafisk-inspektion" class="nav-link" data-scroll-target="#grafisk-inspektion">Grafisk inspektion</a></li>
  <li><a href="#breush-pagan-test" id="toc-breush-pagan-test" class="nav-link" data-scroll-target="#breush-pagan-test">Breush Pagan Test</a></li>
  <li><a href="#robuste-standardfejl" id="toc-robuste-standardfejl" class="nav-link" data-scroll-target="#robuste-standardfejl">Robuste standardfejl</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">
<div class="home-button">

  <a href="index.html">Tilbage</a>

</div>


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Kodeoversigt</h1>
<p class="subtitle lead">Statistik 15 ECTS, Ilisimatusarfik</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Mikkeline Munk Nielsen </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="introduktion" class="level1">
<h1>Introduktion</h1>
<p>Dette dokument giver en oversigt over grundlæggende kode og funktioner i R, som vi skal bruge i kurset. Det er en guide, der hjælper dig med at komme i gang med at oprette objekter, indlæse pakker, arbejde med datasæt, lave grundlæggende datavisualiseringer med <strong>ggplot2</strong> og gennemføre de analyser, som vi arbejder med på kurset.</p>
<p>Du vil finde eksempler på, hvordan du kan arbejde med datasæt, omkode variable og lave forskellige typer af plots og analyser, som du kan tilpasse til dine egne data. Brug dokumentet som en opslagsbog, når du skriver din egen kode eller har brug for at forstå, hvordan specifikke funktioner fungerer.</p>
<p>Husk at du kan kopiere koden direkte fra dokumentet og tilpasse den til dine egne opgaver. Der er også inkluderet eksempler på, hvordan du gemmer dine resultater og visualiseringer.</p>
<p>Du kan benytte indholdsoversigten i højre side til at navigere i kodebogen, eller søge efter specifikke ord ved at trykke <code>Ctrl</code>+<code>F</code> (Windows) eller <code>Cmd</code>+<code>F</code> (Mac) og skrive et søgeord.</p>
</section>
<section id="objekter" class="level1">
<h1>Objekter</h1>
<p>I R er alt, hvad du arbejder med, et objekt. Det kan være tal, tekst, lister eller datasæt. Du opretter objekter, giver dem et navn og kan bruge dem senere.</p>
<p>Du opretter et objekt ved at give det et navn og skrive en pil til højre for navnet, og dernæst definere indholdet af objektet. F.eks. kan vi gemme et objekt, der hedder “mit_foerste_objekt” der indholder teksten “Hello world!”. Vi definerer objektet og dets indhold med en pil</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>mit_foerste_objekt <span class="ot">&lt;-</span> <span class="st">"Hello world!"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Vi kan printe/vise indholdet at objektet ved at køre det i R konsollen eller scriptet:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>mit_foerste_objekt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Hello world!"</code></pre>
</div>
</div>
<p>Du kan naturligvis også gemme tal som objekter…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>mit_tal <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>mit_tal</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
<p>lave beregninger med dine objekter…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>mit_tal <span class="sc">+</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
</div>
<p>og gemme dine resultater i objekter…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>resultat <span class="ot">&lt;-</span> mit_tal <span class="sc">+</span> <span class="dv">2</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>resultat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
</div>
<p>måske vigtigst af alt kan gemme datasæt (dataframes) i objekter:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> datasæt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pakker" class="level1">
<h1>Pakker</h1>
<p>I R indlæser vi pakker, der indeholder forskellige funktioner. Hver pakken skal installeres én gang, og derefter indlæses hver gang vi åbner R-Studio igen.</p>
<section id="installér-pakker" class="level2">
<h2 class="anchored" data-anchor-id="installér-pakker">Installér pakker</h2>
<p>Pakker installeres direkte i konsollen eller scriptet. Her indlæses f.eks. pakken tidyverse, der indeholder en masse gode data-funktioner:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">'tidyverse'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Man kan også indlæse flere pakker samtidig, f.eks. tidyverse OG janitor, som er god til bl.a. tabeller:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="fu">c</span>(<span class="st">'tidyverse'</span>, <span class="st">'janitor'</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="indlæs-pakker" class="level2">
<h2 class="anchored" data-anchor-id="indlæs-pakker">Indlæs pakker</h2>
<p>Pakker indlæses med funktionen library() i dit script.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">'tidyverse'</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Man kan kun indlæse en enkelt pakke af gangen, med mindre man anskaffer sig en package-manager såsom pacmann. Pacman er selv en pakke, der f.eks. indeholder en funktion <code>p_load</code> til at indlæse flere andre pakker på en gang:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, janitor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="datasæt" class="level1">
<h1>Datasæt</h1>
<section id="indlæs-datasæt" class="level2">
<h2 class="anchored" data-anchor-id="indlæs-datasæt">Indlæs datasæt</h2>
<p>R kan som udgangspunkt kun finde datasæt, der er gemt i samme mappe, som den I arbejder i. Derfor er det smart at gemme sine datasæt og filer i samme mappe, som sit R project.</p>
<p>Hvis du er faret vild kan du bruge funktionen <code>getwd()</code> til at printe stien til den mappe, du arbejder i:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "C:/Users/mmn/Dropbox/Ilisimatusarfik"</code></pre>
</div>
</div>
<p>For at indlæse datasæt skal I bruge specifikke funktioner, alt efter hvilket filformat datasættet er.</p>
<p>Til excel-filer:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl) </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>df_excelfil <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"excel_fil.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Til R-filer:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>df_Rfil <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"r_fil.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Hvis dit datasæt ligger i en undermappe, der hedder data, skal du specificere det i stien:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>df_Rfil <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"data/r_fil.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="eksempel" class="level3">
<h3 class="anchored" data-anchor-id="eksempel">Eksempel</h3>
<p>Indlæs f.eks. firmadatasættet med funktionen <code>readRDS</code> og gem datasættet i et objekt, der hedder <code>df</code> (for dataframe):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"firma_data.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="åben-dataset" class="level2">
<h2 class="anchored" data-anchor-id="åben-dataset">Åben dataset</h2>
<p>Brug <code>View()</code> til at åbne datasættet som en tabel</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Brug <code>names()</code> til at printe navnene på variablene i datasættet</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "navn"        "industri"    "ansatte"     "omsaetning"  "tilfredshed"</code></pre>
</div>
</div>
<p>Brug <code>glimpse()</code> til at få et overblik over variablene storage types i R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,000
Columns: 5
$ navn        &lt;chr&gt; "Firm 1", "Firm 2", "Firm 3", "Firm 4", "Firm 5", "Firm 6"…
$ industri    &lt;fct&gt; Finans, Finans, Sundhed, Sundhed, Finans, Produktion, Deta…
$ ansatte     &lt;int&gt; 2766, 962, 4453, 1026, 2022, 2897, 2576, 1459, 1799, 4316,…
$ omsaetning  &lt;dbl&gt; 801603.40, 53875.27, 493462.09, 765705.75, 239915.70, 3386…
$ tilfredshed &lt;ord&gt; Meget tilfreds, Meget utilfreds, Meget utilfreds, Utilfred…</code></pre>
</div>
</div>
</section>
</section>
<section id="data-wrangling" class="level1">
<h1>Data wrangling</h1>
<p>En vigtig fordel i kodebaseret data software er, at vi kan skrive kode, der transformerer vores data til at se ud, præcis som vi vil have det. Det kaldes i folkemunde <em>data wrangling!</em></p>
<section id="omdøbe-variable" class="level2">
<h2 class="anchored" data-anchor-id="omdøbe-variable">Omdøbe variable</h2>
<p>Når vi indlæser et datasæt kan det ofte være smart at sørge for, at variablenes navne er ensartede, så programmet kan læse dem. F.eks. er computere sjældent glade for mellemrum og æ,ø,å…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "køn"                    "tid"                    "Befolkningen.1..januar"</code></pre>
</div>
</div>
<p>Brug <code>clean_names()</code> fra pakken <code>library(janitor)</code> til at ensarte variablenes navne, når du loader et nyt datasæt:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">clean_names</span>(df)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "kon"                   "tid"                   "befolkningen_1_januar"</code></pre>
</div>
</div>
<p>I andre tilfælde vil vi gerne omdøbe variable manuelt. Brug <code>rename()</code> fra pakken <code>library(tidyverse)</code> til manuelt at omdøbe variable:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">koen =</span> kon)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "koen"                  "tid"                   "befolkningen_1_januar"</code></pre>
</div>
</div>
</section>
<section id="omkodning-af-variable" class="level2">
<h2 class="anchored" data-anchor-id="omkodning-af-variable">Omkodning af variable</h2>
<p>Man har ofte behov for at omkode/recode sine variable til færre/andre kategorier eller typer. Ofte vil vi gerne omkode mange variable på én gang. Derfor har pakken <em>dplyr (under tidyverse)</em> introduceret funktionen <code>mutate()</code>.</p>
<p>Logikken er: <code>mutate(df, ny_variabel = gammel_variabel)</code></p>
<section id="eksempler-med-european-social-survey" class="level3">
<h3 class="anchored" data-anchor-id="eksempler-med-european-social-survey">Eksempler med European Social Survey</h3>
<p>Nedenfor indlæses et udsnit af et datasæt fra European Social Survey med køn, alder, uddannelsesniveau og indkomst:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "koen"         "alder"        "udd"          "net_indkomst"</code></pre>
</div>
</div>
<p>Med <code>mutate()</code> kan vi f.eks. tilføje en variabel til vores datasæt, der måler alder kvardreret:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">alder2 =</span> alder<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Udover at omkode variable med matematiske operationer, er det nyttigt at kunne omkode sine variable til nye kategorier på baggrund af forskellige kriterier. I kommer til at stifte bekendtskab med følgende funktione, der skal hjælpe os med at omkode:</p>
<ul>
<li><code>mutate()</code> : hovedfunktionen til at omkode variable</li>
<li><code>if_else()</code> : funktion til at implementere én betingelse</li>
<li><code>case_when()</code> : funktion til at implementere flere betingelser</li>
<li><code>fct_recode()</code> : funktion til specifikt at omkode <code>factor</code> variable</li>
</ul>
<p><code>if_else()</code> kan f.eks. bruges hvis man vil lave en dikotom variabel, der måler, om man er 18 år gammel eller ældre og dermed myndig:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">myndig =</span> <span class="fu">if_else</span>(alder <span class="sc">&gt;=</span> <span class="dv">18</span>,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Myndig"</span>, <span class="co"># Kategori vis den binære betingelse er sand.</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Ikke myndig"</span>)) <span class="co"># Kategori hvis den binære betingelse ikke er sand.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>case_when</code> kan også bruges med funktioner, som i eksemplet nedenfor, hvor funktionen <code>between()</code>er anvendt til at lave en variabel med alderskategorier:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">alder_kategori =</span> <span class="fu">case_when</span>( <span class="co"># Erstat alder_kategori navnet på den nye variabel</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">between</span>(alder, <span class="dv">15</span>, <span class="dv">35</span>) <span class="sc">~</span> <span class="st">"15-35 år"</span>, <span class="co"># Erstat alder med navnet på variablen</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">between</span>(alder, <span class="dv">36</span>, <span class="dv">55</span>) <span class="sc">~</span> <span class="st">"36-55 år "</span>,</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">between</span>(alder, <span class="dv">56</span>, <span class="dv">75</span>) <span class="sc">~</span> <span class="st">"56-75 år"</span>,</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    alder <span class="sc">&gt;</span> <span class="dv">75</span> <span class="sc">~</span> <span class="st">"75 +"</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Hvis man gerne vil omkode factor variabel kan man bruge funktionen <code>fct_recode()</code>. Denne funktion kan også bruges i kombination med mutate.</p>
<p>Logikken er: <code>fct_recode(variabel, ny_kategori = gammel_kategori)</code></p>
<p>F.eks. kan lave en ny variabel for køn, oversat til engelsk med engelske kategorier:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">fct_recode</span>(koen, <span class="st">"Male"</span> <span class="ot">=</span> <span class="st">"Mand"</span>, <span class="st">"Female"</span> <span class="ot">=</span> <span class="st">"Kvinde"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="subsetting" class="level2">
<h2 class="anchored" data-anchor-id="subsetting">Subsetting</h2>
<p>Nogle gange er vi kun interesserede i at arbejde med særlige dele af vores datasæt. Måske er vi f.eks. kun interesseret i to variable fra vores datasæt, eller kun observationer med specifikke værdier på udvalgte variable. I de tilfælde kan vi lave “subsets” af vores datasæt, hvor vi udvælger de specifikke informationer, som vi gerne vil beholde. To nyttige funktioner i arbejde med datasæt/matricer er <code>select()</code> og <code>filter()</code></p>
<p><code>Select()</code> funktionen bruges til at udvælge kolonner/variable i datasættet. Hvis man f.eks. kun er interesseret i variablene koen og net_indkomst, kan man pipe sit dataset over i <code>select()</code>, vælge variablene og gemme dem i et nyt datasæt:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>ny_df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">select</span>(koen, net_indkomst)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Mens <code>select()</code> uvælger kolonner/variable, kan man bruge <code>filter()</code> til at vælge rækker/observationer på baggrund af specifikationer. Hvis man f.eks. kun er interesseret i resultater for kvinder i sit datasæt, kan man pipe sit dataset over i <code>filter()</code> og dermed kun beholde observationer, der har værdien = “kvinde” på variablen “koen”:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>kvinde_df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(koen<span class="sc">==</span><span class="st">"Kvinde"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="gruppering-af-data" class="level2">
<h2 class="anchored" data-anchor-id="gruppering-af-data">Gruppering af data</h2>
<p>Somme tider er det nytting at aggregere sit datasæt i nogle grupper. <code>group_by()</code> bruges til at gruppere data efter én eller flere variabler, som allerede er i dit datasæt.</p>
<p>Funktionen laver grupper i datasættet, som derefter kan opsummeres eller manipuleres separat. Når dine data er grupperet, kan du bruge <code>summarise()</code> i forlængelse af <code>groupby()</code> til at beregne opsummeringer for hver gruppe. Eksempler på opsummeringer: gennemsnit, median, sum eller brugerdefinerede beregninger.</p>
<p><br></p>
<p>Vi kan f.eks. bruge <code>groupby()</code> til at gruppere uddannelsesniveau og derefter <code>summarise()</code> til at beregne gennemsnitsindkomsten og antal observationer for hver gruppe:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(udd) <span class="sc">%&gt;%</span> </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Gennemsnitsindkomst =</span> <span class="fu">mean</span>(net_indkomst, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">N =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  udd                         Gennemsnitsindkomst     N
  &lt;ord&gt;                                     &lt;dbl&gt; &lt;int&gt;
1 Grundskole                                4075.  3087
2 Ungdoms-/erhvervsuddannelse               5545.  4501
3 Mellemlang videregående                   8627.  3934
4 Lang videregående                         9401.  2148
5 &lt;NA&gt;                                      6909.   129</code></pre>
</div>
</div>
</section>
<section id="dummy-variable" class="level2">
<h2 class="anchored" data-anchor-id="dummy-variable">Dummy-variable</h2>
<p>Særligt i regressionsanalyse er det nyttigt at kunne omkode diskrete variable til dummy variable. Princippet med dummier er, at man konstruerer en binær variabel for hver kategori på en disktret variabel. Disse binære variable tager enten værdien 0 eller 1. En variabel for køn med to kategorier, Mand og Kvinde, kodes til to nye variable:</p>
<ul>
<li><p>Mand</p></li>
<li><p>Kvinde</p></li>
</ul>
<p>Respondenter med værdien “Kvinde” på den oprindelige variabel køn, tager værdien 1 på den nye variable Kvinde. Mænd tager værdien 0. Det omvendte gælder, på variablen Mand.</p>
<p>Før vi laver dummier af en diskret variabel, skal vi danne os et overblik over dens kategorier. Start derfor med at lave en tabel over kategorierne på variablen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(df<span class="sc">$</span>koen)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> df$koen    n   percent
    Mand 6730 0.4877165
  Kvinde 7069 0.5122835</code></pre>
</div>
</div>
<p>Variablen har to kategorier, “Mand” og “Kvinde”. Vi konstruerer derfor to nye variable - én for hver kategori på den oprindelige variabel - og tilføjer dem til datasættet. Vi bruger funktionerne <code>mutate()</code> og <code>ifelse()</code> til omkode og/eller at skabe nye variable og tilføje dem til datasættet.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="at">mand =</span> <span class="fu">ifelse</span>(koen<span class="sc">==</span><span class="st">"Mand"</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="at">kvinde =</span> <span class="fu">ifelse</span>(koen<span class="sc">==</span><span class="st">"Kvinde"</span>,<span class="dv">1</span>,<span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Vi har nu tilføjet to dummy-variable til datasættet:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">select</span>(koen, mand, kvinde) <span class="sc">%&gt;%</span> head</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  koen    mand kvinde
  &lt;fct&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1 Kvinde     0      1
2 Kvinde     0      1
3 Kvinde     0      1
4 Mand       1      0
5 Kvinde     0      1
6 Kvinde     0      1</code></pre>
</div>
</div>
</section>
</section>
<section id="ggplot" class="level1">
<h1>ggplot</h1>
<p><strong>ggplot2</strong> er en datavisualiseringspakke i R. Den er bygget på <em>grammar of graphics</em> og giver fleksibilitet til at skabe avancerede plots. I skal bruge den til at bygge figurer!</p>
<section id="de-tre-grundelementer-i-ggplot2" class="level3">
<h3 class="anchored" data-anchor-id="de-tre-grundelementer-i-ggplot2">De tre grundelementer i ggplot2</h3>
<ul>
<li><code>data</code>: data, du vil plotte</li>
<li><code>aes</code>:kortlægning af variabler (aesthetic mappings)</li>
<li><code>geom</code><strong>:</strong> plot-type, f.eks. søjlediagram, scatterplot, eller boksplot</li>
</ul>
<p>ggplot2 er som at bygge med LEGO-klodser: Du tilføjer forskellige lag for at skabe det endelige plot. Hvert lag bygger på det forrige og tilføjer nye visuelle elementer. Basen er data, og derfra bygger du videre med lag som akser, farver og geometriske former</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="sc">&lt;</span>DATA<span class="sc">&gt;</span>) <span class="sc">+</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">&lt;</span>X<span class="sc">-</span>variabel<span class="sc">&gt;</span>, <span class="at">y =</span> <span class="sc">&lt;</span>Y<span class="sc">-</span>variabel<span class="sc">&gt;</span>) <span class="sc">+</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  geom_<span class="sc">&lt;</span>GEOM<span class="sc">&gt;</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="typer-af-plots" class="level3">
<h3 class="anchored" data-anchor-id="typer-af-plots">Typer af plots</h3>
<p>Der findes mange typer af plots eller <strong><em>geoms</em></strong>, som er gode til forskellige ting. Her er et par grundlæggende:</p>
<p><u>Visualisering af én variabel</u></p>
<ul>
<li><p>Brug <code>geom_bar()</code> til kategoriske variable</p></li>
<li><p>Brug <code>geom_histogram()</code> eller <code>geom_boxplot</code> til nummeriske variable</p></li>
</ul>
<p><u>Visualisering af flere variable</u></p>
<ul>
<li><p>Brug <code>geom_bar()</code> eller <code>geom_jitter()</code> til to kategoriske variable</p></li>
<li><p>Brug <code>geom_boxplot</code> til en nummerisk variabel og en kategoriske variabel.</p></li>
<li><p>Brug <code>geom_point()</code> til to nummeriske variable.</p></li>
</ul>
<p>Nedenfor illustreres hver plottype med udgangspunkt i datasættet <strong><em>mtcars</em></strong> (built in datasæt på biler).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> mtcars</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="barplot-univariat" class="level4">
<h4 class="anchored" data-anchor-id="barplot-univariat">Barplot (univariat)</h4>
<p>Variablen <strong>cyl</strong> (antal cylindre), som er en kategorisk variabel, kan visualiseres via. et barplot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span> </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(cyl)) <span class="sc">+</span>  <span class="co"># Erstat cyl med din variabel</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"#003366"</span>) <span class="sc">+</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Antal biler pr. antal cylindere"</span>,</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Antal cylindre"</span>,</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Antal biler"</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="kodeoversigt_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="histogram-univariat" class="level4">
<h4 class="anchored" data-anchor-id="histogram-univariat">Histogram (univariat)</h4>
<p>Variablen <strong>mpg</strong> (miles per gallon), som er en numerisk, kan visualiseres via. et histogram:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> mpg) <span class="sc">+</span> <span class="co"># Erstat mpq med din variabel</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"#003366"</span>) <span class="sc">+</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Histogram af brændstoføkonomi"</span>,</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Miles per gallon (mpg)"</span>,</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Antal biler"</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="kodeoversigt_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="boksplot-univariat" class="level4">
<h4 class="anchored" data-anchor-id="boksplot-univariat">Boksplot (univariat)</h4>
<p>Variablen <strong>mpg</strong> (miles per gallon), som er en numerisk, kan også visualiseres via. et boksplot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> mpg) <span class="sc">+</span>  <span class="co"># Erstat mpq med navnet på din variabel. </span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"#003366"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span>  <span class="co"># Ændring af farver</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Boksplot af brændstoføkonomi"</span>,</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>,  <span class="co"># Tomt for at undgå en x-akse etiket</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Miles per gallon (mpg)"</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="kodeoversigt_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="barplot-bivariat" class="level4">
<h4 class="anchored" data-anchor-id="barplot-bivariat">Barplot (bivariat)</h4>
<p>Vi kan visualisere sammenhængen mellem variablene <strong>cyl</strong> (antal cylindre) og <strong>gear</strong> (antal gear), som begge er kategoriske variabler via <code>barplot()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span> </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(cyl), <span class="at">fill =</span> <span class="fu">factor</span>(gear)) <span class="sc">+</span> <span class="co"># Erstat cyl og gear med dine variable</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Fordeling af biler pr. cylinder og gear"</span>,</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Antal cylindre"</span>,</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Antal biler"</span>,</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Antal gear"</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="kodeoversigt_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="jitter-plot-bivariat" class="level4">
<h4 class="anchored" data-anchor-id="jitter-plot-bivariat">Jitter-plot (bivariat)</h4>
<p>Vi kan også visualisere sammenhængen mellem <strong>cyl</strong> (antal cylindre) og <strong>gear</strong> (antal gear) via <code>geom_jitter()</code>. Et jitter-plot er en variant af et scatterplot, hvor punkterne bliver “spredt” (jittered) lidt tilfældigt, når de overlapper hinanden:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span> </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(cyl), <span class="at">y =</span> <span class="fu">factor</span>(gear)) <span class="sc">+</span> <span class="co"># Erstat cyl og gear med dine variable</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">height =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Spredning af biler mellem cylinder og gear"</span>,</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Antal cylindre"</span>,</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Antal gear"</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="kodeoversigt_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="boksplot-bivariat" class="level4">
<h4 class="anchored" data-anchor-id="boksplot-bivariat">Boksplot (bivariat)</h4>
<p>Vi kan bruge et boksplot til at se fordelingen af variablene <strong>mpg</strong> (nummerisk) over <strong>cyl</strong> (kategorisk):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span> </span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(cyl), <span class="at">y =</span> mpg) <span class="sc">+</span> <span class="co"># Erstat cyl og mpg med dine variable</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Brændstoføkonomi pr. cylinder"</span>,</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Antal cylindre"</span>,</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Miles per gallon"</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="kodeoversigt_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="scatterplot-bivariat" class="level4">
<h4 class="anchored" data-anchor-id="scatterplot-bivariat">Scatterplot (bivariat)</h4>
<p>Og vi kan bruge et scatterplot til at se sammenhængen mellem variablene <strong>wt</strong> (vægt) og <strong>mpg</strong> (miles per gallon), som begge er numeriske variabler med <code>geom_point()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span> </span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> wt, <span class="at">y =</span> mpg) <span class="sc">+</span> <span class="co"># Erstat wt og mpg med dine variable</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Sammenhæng mellem vægt og brændstoføkonomi"</span>,</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Vægt (1000 lbs)"</span>,</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Miles per gallon"</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="kodeoversigt_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="scatterplot-bivariat-med-regressionslinje" class="level4">
<h4 class="anchored" data-anchor-id="scatterplot-bivariat-med-regressionslinje">Scatterplot (bivariat) med regressionslinje</h4>
<p>Det er også muligt at lægge flere plots ovenpå hinanden med ggplot. F.eks. kan I lægge en regressionslinje indover jeres scatterplot med <code>geom_smooth()</code> :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span> </span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> wt, <span class="at">y =</span> mpg) <span class="sc">+</span> <span class="co"># Erstat wt og mpg med dine variable</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span>  <span class="co"># Tilføjer en lineær regressionslinje</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Sammenhæng mellem vægt og brændstoføkonomi"</span>,</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Vægt (1000 lbs)"</span>,</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"MPG"</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="kodeoversigt_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="ændring-af-plot-udseende" class="level2">
<h2 class="anchored" data-anchor-id="ændring-af-plot-udseende">Ændring af plot-udseende</h2>
<p>ggplots kan nemt ændres ved at tilføje elementer til graferne (ligesom LEGO-klodser). Nedenfor illustreres et par typiske ændringer, med udgangspunkt i et simpelt plot, der kortlægger variablene <strong>wt</strong> (vægt) til x-aksen og <strong>mpg</strong> (miles per gallon) til y-aksen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df) <span class="sc">+</span> </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> wt, <span class="at">y =</span> mpg) <span class="sc">+</span> <span class="co"># Erstat wt og mpg med dine variable</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="kodeoversigt_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Man kan bruge funktionen <code>labs()</code> til at tilføje titel og asketitler:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df) <span class="sc">+</span> </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> wt, <span class="at">y =</span> mpg) <span class="sc">+</span> <span class="co"># Erstat wt og mpg med dine variable</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Relationship between Weight and Fuel Efficiency"</span>,</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Weight (1000 lbs)"</span>,</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Miles per gallon"</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="kodeoversigt_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Man kan ændre dine plots visuelle udseende med <code>themes()</code>. Man kan f.eks. ændre baggrunde, akser, tekst, grids, osv., ved at bruge forskellige temaer ggplot2 kommer med flere indbyggede temaer, f.eks. <code>theme_minimal():</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df) <span class="sc">+</span> </span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> wt, <span class="at">y =</span> mpg) <span class="sc">+</span> <span class="co"># Erstat wt og mpg med dine variable</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Relationship between Weight and Fuel Efficiency"</span>,</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Weight (1000 lbs)"</span>,</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Miles per gallon"</span>) <span class="sc">+</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="kodeoversigt_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Det er ofte nødvendigt at skrue på værdierne på akserne. Afhængigt af hvilken akse man vil justere bruger man:</p>
<ul>
<li><p><code>scale_x_discrete()</code>: Bruges til diskrete (kategoriske) værdier på x-aksen</p></li>
<li><p><code>scale_x_continuous()</code>: Bruges til kontinuære (numeriske) værdier på x-aksen</p></li>
<li><p><code>scale_y_discrete()</code>: Bruges til diskrete værdier på y-aksen</p></li>
<li><p><code>scale_y_continuous()</code>: Bruges til kontinuære værdier på y-aksen.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df) <span class="sc">+</span> </span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> wt, <span class="at">y =</span> mpg) <span class="sc">+</span> <span class="co"># Erstat wt og mpg med dine variable</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Relationship between Weight and Fuel Efficiency"</span>,</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Weight (1000 lbs)"</span>,</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Miles per gallon"</span>) <span class="sc">+</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">6</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">6</span>, <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">40</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">40</span>, <span class="at">by =</span> <span class="dv">5</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="kodeoversigt_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Man kan også ændre farver på sine ggplots. Afhængigt af hvilken type geometrisk objekt du arbejder med, bruger man <code>fill()</code> eller <code>color()</code>. <strong><code>color()</code></strong> ændrer kantfarver og punktfarver, <code>fill()</code> ændrer fyldfarver på objekter, der har en indre fyldning. I et scatterplot med punkter bruges <code>color()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df) <span class="sc">+</span> </span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> wt, <span class="at">y =</span> mpg) <span class="sc">+</span> <span class="co"># Erstat wt og mpg med dine variable</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">"purple"</span>) <span class="sc">+</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Relationship between Weight and Fuel Efficiency"</span>,</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Weight (1000 lbs)"</span>,</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Miles per gallon"</span>) <span class="sc">+</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">6</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">6</span>, <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">40</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">40</span>, <span class="at">by =</span> <span class="dv">5</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="kodeoversigt_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Man kan ændre tekst-størrelsen på plottets elementer med <code>theme()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df) <span class="sc">+</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> wt, <span class="at">y =</span> mpg) <span class="sc">+</span> <span class="co"># Erstat wt og mpg med dine variable</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">"purple"</span>) <span class="sc">+</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Relationship between Weight and Fuel Efficiency"</span>,</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Weight (1000 lbs)"</span>,</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Miles per gallon"</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">6</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">6</span>, <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">40</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">40</span>, <span class="at">by =</span> <span class="dv">5</span>))<span class="sc">+</span></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>),          <span class="co"># Ændrer titelstørrelsen</span></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),        <span class="co"># Ændrer størrelsen på x-aksetitlen</span></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),        <span class="co"># Ændrer størrelsen på y-aksetitlen</span></span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),         <span class="co"># Ændrer størrelsen på x-akse tekst (ticks)</span></span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))          <span class="co"># Ændrer størrelsen på y-akse tekst (ticks)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="kodeoversigt_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Nogle gange kan det også være nyttigt at rotere sit plot med <code>coord_flip()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df) <span class="sc">+</span> </span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> wt, <span class="at">y =</span> mpg) <span class="sc">+</span> <span class="co"># Erstat wt og mpg med dine variable</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">"purple"</span>) <span class="sc">+</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Relationship between Weight and Fuel Efficiency"</span>,</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Weight (1000 lbs)"</span>,</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Miles per gallon"</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">6</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">6</span>, <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">40</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">40</span>, <span class="at">by =</span> <span class="dv">5</span>))<span class="sc">+</span></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>),          <span class="co"># Ændrer titelstørrelsen</span></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),        <span class="co"># Ændrer størrelsen på x-aksetitlen</span></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),        <span class="co"># Ændrer størrelsen på y-aksetitlen</span></span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),         <span class="co"># Ændrer størrelsen på x-akse tekst (ticks)</span></span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)) <span class="sc">+</span>  <span class="co"># Ændrer størrelsen på y-akse tekst (ticks) </span></span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="co"># Roterer akserne</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="kodeoversigt_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="gem-dit-ggplot" class="level2">
<h2 class="anchored" data-anchor-id="gem-dit-ggplot">Gem dit ggplot</h2>
<p>Standardmetoden til at gemme ggplot-grafer er ved hjælp af <code>ggsave()</code> funktionen. Først gemmes dit plot som et objekt, dernæst bruges <code>ggsave()</code> med følgende syntaks:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"mit_plot.jpeg"</span>, <span class="co"># Erstat med navnet du vil gemme .jpeg filen som</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> mit_ggplot_objekt, <span class="co"># Erstat mit_ggplot_objekt med navnet på det objekt, du har gemt dit plot i</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><p><code>mit_ggplot_objekt</code> er navnet på det objekt, du har gemt dit plot i</p></li>
<li><p><code>ggsave()</code> kan gemme i forskellige filformater: JPEG, PNG, PDF, TIFF osv.</p></li>
<li><p>Gem som udgangspunkt i JPEG</p></li>
<li><p>Juster størrelse med <code>width</code> og <code>height</code> (i tommer).</p></li>
</ul>
<p>Medmindre du specificerer en anden lokation på computeren gemmes plottet i den mappe, som du arbejder i (tjek evt. med <code>getwd()</code>).</p>
</section>
</section>
<section id="tabeller" class="level1">
<h1>Tabeller</h1>
<section id="envejstabeller" class="level2">
<h2 class="anchored" data-anchor-id="envejstabeller">Envejstabeller</h2>
<p>Brug funktionen <code>tabyl()</code> fra pakken <code>janitor</code> til at lave tabeller. Du kan f.eks. lave en envejstabel med frekvenser og andele på variablen <strong>udd</strong> fra ESS datasættet således:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)  </span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(df, udd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                         udd    n     percent valid_percent
                  Grundskole 3087 0.223711863     0.2258230
 Ungdoms-/erhvervsuddannelse 4501 0.326183057     0.3292612
     Mellemlang videregående 3934 0.285093123     0.2877835
           Lang videregående 2148 0.155663454     0.1571324
                        &lt;NA&gt;  129 0.009348504            NA</code></pre>
</div>
</div>
</section>
<section id="tovejstabellerkrydstabeller" class="level2">
<h2 class="anchored" data-anchor-id="tovejstabellerkrydstabeller">Tovejstabeller/krydstabeller</h2>
<p>En tabel med to variable kaldes også en tovejs-tabel eller en <strong>krydstabel.</strong> En krydstabel er en tabel, der organiserer data for to kategoriske variable og viser, hvordan observationer fordeler sig <strong>i</strong> kombination af de to variable.</p>
<p>Brug funktionen <code>tabyl()</code> fra pakken <code>janitor</code> til at lave tabeller. Du kan f.eks. lave en krydstabel med R datasættet <code>Titanic</code> over passageres klasse og overlevelse:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(df, Class, Survived) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Class No Yes
   1st  4   4
   2nd  4   4
   3rd  4   4
  Crew  4   4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Erstat variablene class og survived med navnene på dine variable</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Tilføj totaler (både rækker og kolonner) med <code>adorn_totals()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(df, Class, Survived) <span class="sc">%&gt;%</span> <span class="fu">adorn_totals</span>(<span class="at">where =</span> <span class="fu">c</span>(<span class="st">"row"</span>, <span class="st">"col"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Class No Yes Total
   1st  4   4     8
   2nd  4   4     8
   3rd  4   4     8
  Crew  4   4     8
 Total 16  16    32</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Erstat variablene class og survived med navnene på dine variable</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Tilføj procenter med <code>adorn_percentages()</code> og bestem antal decimaler med <code>adorn_pct_formatting()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(df, Class, Survived) <span class="sc">%&gt;%</span> </span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>(<span class="at">where =</span> <span class="fu">c</span>(<span class="st">"row"</span>, <span class="st">"col"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_percentages</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_pct_formatting</span>(<span class="at">digits =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Class    No   Yes  Total
   1st 50.0% 50.0% 100.0%
   2nd 50.0% 50.0% 100.0%
   3rd 50.0% 50.0% 100.0%
  Crew 50.0% 50.0% 100.0%
 Total 50.0% 50.0% 100.0%</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Erstat variablene class og survived med navnene på dine variable</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="gem-din-tabel-som-excel-fil" class="level2">
<h2 class="anchored" data-anchor-id="gem-din-tabel-som-excel-fil">Gem din tabel som excel-fil</h2>
<p>Du kan eksportere din både envejs- og tovejstabeller til Excel med <code>writexl</code>-pakken ved at gemme tabellen i et objekt og bruge funktionen <code>write_xlxs()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>min_tabel <span class="ot">&lt;-</span> <span class="fu">tabyl</span>(df, udd)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(writexl) </span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(<span class="fu">list</span>(<span class="st">"Min tabel"</span> <span class="ot">=</span> min_tabel), <span class="st">"min_tabel.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="univariat-analyse" class="level1">
<h1>Univariat analyse</h1>
<section id="centrummål" class="level2">
<h2 class="anchored" data-anchor-id="centrummål">Centrummål</h2>
<p>Mål for en variabels centrale tendens siger noget om en ”typiske” værdi på variablen. Man taler oftest om tre centrummål:</p>
<ul>
<li><p><strong>Typetal</strong>: den værdi, der optræder flest gange (kaldes også modus eller modalværdi)</p></li>
<li><p><strong>Middelværdi/gennemsnit</strong>: <span class="math inline">\(\bar{x} = \frac{1}{N} \sum_{i=1}^{N} x_i\)</span></p></li>
<li><p><strong>Median</strong>: værdien af den midterste observation på en variabel eller gennemsnittet mellem de to midterste (den værdi, der deler enhederne i to lige store dele).</p></li>
</ul>
<section id="typetalmodus" class="level3">
<h3 class="anchored" data-anchor-id="typetalmodus">Typetal/modus</h3>
<p>Vi kan bruge <code>Mode()</code> funktionen fra pakken <code>DescTools</code> til at finde typetallet. Vi er dog nødt til at fortælle funktionen, at den skal ignorere missing-værdier, før den virker, ved at skrive: <code>na.rm = TRUE.</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DescTools)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Mode</span>(df<span class="sc">$</span>udd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] Ungdoms-/erhvervsuddannelse
attr(,"freq")
[1] 4501
4 Levels: Grundskole &lt; ... &lt; Lang videregående</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># df er navnet på objektet med datasættet, udd er navnet på variablen</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>Mode()</code> fortæller os at modus på variablen <strong>uddannelse</strong> er <em>Ungdoms-/erhvervsuddannelse</em>, og at det optræder 4501 gange i datasættet.</p>
</section>
<section id="gennemsnitmiddelværdi" class="level3">
<h3 class="anchored" data-anchor-id="gennemsnitmiddelværdi">Gennemsnit/middelværdi</h3>
<p>Du kan finde middelværdien af en intervalskaleret variabel med funktionen <code>Mean()</code>. Igen er vi nødt til at fortælle funktionen, at den skal ignorere missing-værdier, før den virker, ved at skrive: <code>na.rm = TRUE</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DescTools)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Mean</span>(df<span class="sc">$</span>alder, <span class="at">na.rm =</span> T) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 50.78924</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># df er navnet på objektet med datasættet, alder er navnet på variablen</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="median" class="level3">
<h3 class="anchored" data-anchor-id="median">Median</h3>
<p>Du kan finde medianen på en ordinal- eller intervalskaleret variabel med funktionen <code>Median()</code>. Igen er vi nødt til at fortælle funktionen, at den skal ignorere missing-værdier, før den virker, ved at skrive: <code>na.rm = TRUE</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DescTools)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Median</span>(df<span class="sc">$</span>alder, <span class="at">na.rm=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 52</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># df er navnet på objektet med datasættet, alder er navnet på variablen</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="fraktiler" class="level2">
<h2 class="anchored" data-anchor-id="fraktiler">Fraktiler</h2>
<p>Hvis du er interesseret i andre fraktiler kan du bruge funktionen quantile(). Hvis det f.eks. gerne vil have kvartiler på en variable, kan du specificere følgende fraktiler:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(df<span class="sc">$</span>alder, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>25% 50% 75% 
 35  52  66 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># df er navnet på objektet med datasættet, alder er navnet på variablen</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="all-in-one-summary" class="level3">
<h3 class="anchored" data-anchor-id="all-in-one-summary">All-in-one summary</h3>
<p>En god funktion er <code>summary()</code> som viser: minimum (<code>Min.</code>), første kvartil (<code>1st Qu.</code>), median (<code>Median</code>), gennemsnit (<code>Mean</code>), tredje kvartil (<code>3rd Qu.</code>), maximum (<code>Max.</code>), og manglende værdier (<code>NA</code>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df<span class="sc">$</span>alder)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
  15.00   35.00   52.00   50.79   66.00   90.00      20 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># df er navnet på objektet med datasættet, alder er navnet på variablen</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="spredningsmål" class="level2">
<h2 class="anchored" data-anchor-id="spredningsmål">Spredningsmål</h2>
<p>Udover den ”typiske værdi” er det informativt at undersøge spredningen på en variabel, dvs. hvor langt de forskellige enheders værdier ligger fra hinanden. Spredningsmål siger altså noget om variationen i data, og beskæftiger sig med, hvor meget observationerne afviger fra middelværdien.</p>
<p>Du kan finde variansen på en variabel med funktionen <code>Var()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Var</span>(df<span class="sc">$</span>alder, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 360.6049</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># df er navnet på objektet med datasættet, alder er navnet på variablen</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Eller standardafvigelsen med funktionen <code>sd()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(df<span class="sc">$</span>alder, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 18.9896</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># df er navnet på objektet med datasættet, alder er navnet på variablen</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="konfidensintervaller" class="level2">
<h2 class="anchored" data-anchor-id="konfidensintervaller">Konfidensintervaller</h2>
<p>Man kan bruge funktionen <code>t.test()</code> til at udregne konfidensintervaller (95 % konfidensintervaller er standard):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(df<span class="sc">$</span>alder)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  df$alder
t = 313.95, df = 13778, p-value &lt; 2.2e-16
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 50.47215 51.10634
sample estimates:
mean of x 
 50.78924 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># df er navnet på objektet med datasættet, alder er navnet på variablen</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Konfidensintervallerne fortæller os, at populationsgennemsnittet <span class="math inline">\(\mu\)</span> med 95% sandsynlighed ligger i intervallet <span class="math inline">\(50,47\)</span> og <span class="math inline">\(51,1\)</span> år.</p>
</section>
<section id="t-test-for-univariat-analyse" class="level2">
<h2 class="anchored" data-anchor-id="t-test-for-univariat-analyse">T-test for univariat analyse</h2>
<p>I univariat analyse kan man anvende t-testen til formelt at teste, om gennemsnittet i ens stikprøve er signifikant forskelligt fra en forventet værdi (f.eks. Hvis du har viden om populationens sande gennemsnit). Vi bruger funktionen <code>t.test()</code>.</p>
<p>Vi kan f.eks. teste om gennemsnitsalderen i stikprøven (<span class="math inline">\(\bar{x}\)</span>) er signifikant forskellig fra gennemsnitsalderen i populationen i 2020: <span class="math inline">\(\mu=42,8\)</span>. Hypoteserne for en univariat t-test er:</p>
<ul>
<li><strong>H0</strong>: Stikprøvegennemsnittet er lig populationens/det forventede gennemsnit, <span class="math inline">\(\bar{x}=μ\)</span></li>
<li><strong>H1:</strong> Stikprøvegennemsnittet er forskelligt fra populationens/det forventede gennemsnit <span class="math inline">\(\bar{x}\ne \mu\)</span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>ttest_resultat_univariat <span class="ot">&lt;-</span> <span class="fu">t.test</span>(df<span class="sc">$</span>alder, <span class="at">mu =</span> <span class="fl">42.8</span>)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="co"># df er navnet på objektet med datasættet, alder er navnet på variablen</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Opret en data frame med de ønskede metrics i rækker</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>(ttest_tabel_univariat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Parameter =</span> <span class="fu">c</span>(<span class="st">"Gennemsnit"</span>,                <span class="co"># Gennemsnittet af prøven</span></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Test-statistik"</span>,               <span class="co"># Teststatistikken (t-værdien)</span></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>             <span class="st">"P-værdi"</span>,                      <span class="co"># P-værdien med 4 decimaler</span></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Nedre konfidensinterval"</span>,      <span class="co"># Nedre konfidensinterval for konfidensintervallet</span></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Øvre konfidensinterval"</span>,       <span class="co"># Øvre konfidensinterval for konfidensintervallet</span></span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Frihedsgrader"</span>),               <span class="co"># Frihedsgrader (df)</span></span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>  Værdi <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(ttest_resultat_univariat<span class="sc">$</span>estimate, <span class="dv">3</span>),       <span class="co"># Gennemsnittet afrundet til 3 decimaler</span></span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(ttest_resultat_univariat<span class="sc">$</span>statistic, <span class="dv">3</span>),      <span class="co"># Teststatistikken afrundet til 3 decimaler</span></span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, ttest_resultat_univariat<span class="sc">$</span>p.value), <span class="co"># P-værdi med 3 decimaler </span></span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(ttest_resultat_univariat<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="dv">3</span>),    <span class="co"># Nedre konfidensinterval afrundet til 3 decimaler</span></span>
<span id="cb102-17"><a href="#cb102-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(ttest_resultat_univariat<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="dv">3</span>),    <span class="co"># Øvre konfidensinterval afrundet til 3 decimaler</span></span>
<span id="cb102-18"><a href="#cb102-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(ttest_resultat_univariat<span class="sc">$</span>parameter, <span class="dv">1</span>)       <span class="co"># Frihedsgrader afrundet til 1 decimal</span></span>
<span id="cb102-19"><a href="#cb102-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb102-20"><a href="#cb102-20" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                Parameter  Værdi
1              Gennemsnit 50.789
2          Test-statistik 49.385
3                 P-værdi  0.000
4 Nedre konfidensinterval 50.472
5  Øvre konfidensinterval 51.106
6           Frihedsgrader  13778</code></pre>
</div>
</div>
<p>Da p-værdien er under 0,05 forkaster vi nulhypotesen og konkluderer vi, at gennemsnitsalderen i stikprøven (<span class="math inline">\(\bar{x}\)</span>) er signifikant lavere end den forventede værdi (gennemsnitsalderen i populationen, <span class="math inline">\(\mu\)</span>).</p>
<p>Du kan samle outputtet fra t-testen i en lidt pænere tabel og eksportere den, ved at følge nedenstående kode:<br>
</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(writexl) </span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(ttest_tabel_univariat, <span class="st">"t_test_resultat_univariat.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ttest_resultat_univariat er navnet på objektet med tabellen med t-test resultatet</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="chi2-test-for-univariat-analyse-goodness-of-fit" class="level2">
<h2 class="anchored" data-anchor-id="chi2-test-for-univariat-analyse-goodness-of-fit"><span class="math inline">\(\chi^2\)</span>-test for univariat analyse (goodness of fit)</h2>
<p>Ordinal og nominalskalerede variable har ikke gennemsnit og varians uafhængigt af vores nummerering og derfor er disse meningsløse. T-testen er derfor også meningsløs. I stedet tester vi, om fordelingen mellem variablens kategorier er forskellig fra en forventet fordeling.</p>
<p>Testen hedder χ² – udtales ‘Chi i anden’ eller <strong>goodness of fit</strong>. Vi bruger <span class="math inline">\(\chi^2\)</span> goodness of fit testen til at teste, om fordelingen på variablen i stikprøven stemmer overens med en forventet fordeling. F.eks. kan vi teste, om uddannelsesfordelingen i stikprøven stemmer overens med en forventet uddannelsesfordeling.</p>
<p>Hypoteserne i en goodness-of-fit test er:</p>
<ul>
<li><strong>H0</strong>: Den observerede fordeling er ikke signifikant forskellig fra den forventede fordeling</li>
<li><strong>H1</strong>: Den observerede fordeling er signifikant forskellig fra den forventede fordeling</li>
</ul>
<p>Den observerede fordeling i stikprøven er:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(df<span class="sc">$</span>udd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      df$udd    n     percent valid_percent
                  Grundskole 3087 0.223711863     0.2258230
 Ungdoms-/erhvervsuddannelse 4501 0.326183057     0.3292612
     Mellemlang videregående 3934 0.285093123     0.2877835
           Lang videregående 2148 0.155663454     0.1571324
                        &lt;NA&gt;  129 0.009348504            NA</code></pre>
</div>
</div>
<p>De observerede værdier er antallet i hver kategori <span class="math inline">\((n)\)</span>, og den forventede fordeling er en sandsynlighedsfordeling <span class="math inline">\((p)\)</span>.</p>
<p>De observerede værdier fra tabellen er:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>observeret <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3087</span>, <span class="dv">4501</span>, <span class="dv">3934</span>, <span class="dv">2148</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Den forrventede fordeling på variablen udtrykkes som andele, f.eks. 15% grundskole, 30% Ungdoms-/erhvervsuddannelse, 30 % mellemlang videregående, 25 % lang videregående:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>forventet_andele <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.15</span>, <span class="fl">0.30</span>, <span class="fl">0.30</span>, <span class="fl">0.25</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Brug funktionen <code>chisq.test()</code> for at sammenligne de observerede værdier med de forventede, og gem resultaterne i en tabel med følgende kode:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>chi_test_univariat <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(<span class="at">x =</span> observeret, <span class="at">p =</span> forventet_andele)</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Formatér test-resultater og gem som tabel</span></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>(chi_tabel_univariat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Parameter =</span> <span class="fu">c</span>(<span class="st">"Chi-squared"</span>, <span class="st">"Frihedsgrader"</span>, <span class="st">"p-værdi"</span>),</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>  Værdi <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">formatC</span>(chi_test_univariat<span class="sc">$</span>statistic, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">3</span>),  <span class="co"># Chi-squared værdi</span></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>            chi_test_univariat<span class="sc">$</span>parameter,                                     <span class="co"># Frihedsgrader</span></span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">formatC</span>(chi_test_univariat<span class="sc">$</span>p.value, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">3</span>))    <span class="co"># p-værdi</span></span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Parameter    Værdi
X-squared   Chi-squared 1041.334
df        Frihedsgrader        3
                p-værdi    0.000</code></pre>
</div>
</div>
<p>P-værdien på 0,000 er under 0,05 og vi afviser dermed nulhypotesen og konkluderer, at uddannelsesfordelingen i stikprøven er signifikant forskellig fra den forventede fordeling.</p>
<p>Du kan som altid eksportere tabellen med dine resultater fra testen til excel med <code>write.csv()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(writexl) </span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(chi_tabel_univariat, <span class="st">"chi_test_univariat.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="co"># chi_tabel_univariat er navnet på objektet med tabellen med chi-test resultatet</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="bivariat-analyse" class="level1">
<h1>Bivariat analyse</h1>
<section id="korrelationskoefficienter" class="level2">
<h2 class="anchored" data-anchor-id="korrelationskoefficienter">Korrelationskoefficienter</h2>
<section id="cramers-v" class="level3">
<h3 class="anchored" data-anchor-id="cramers-v">Cramers v</h3>
<p>Når der indgår en nominalskala variabel anbefales det at bruge korrelationsmålet Cramer’s <span class="math inline">\(V\)</span>. Denne korrelationskoefficient ligger mellem <span class="math inline">\(0\)</span> og <span class="math inline">\(1\)</span>. Brug funktionen <code>CramerV</code> fra pakken <code>DescTools</code>:</p>
<p><em>Eksempel med køn og ansættelsestype fra European Social Survey:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>krydstabel <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">as.character</span>(df<span class="sc">$</span>koen), </span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">as.character</span>(df<span class="sc">$</span>ansaettelse_type)) </span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Erstat koen og ansaettelse_type med dine variable</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DescTools) </span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a><span class="fu">CramerV</span>(krydstabel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1169228</code></pre>
</div>
</div>
<ul>
<li>Cramer’s <span class="math inline">\(V=0.12\)</span></li>
<li>Der ser ud til at være en svag sammenhæng mellem køn og ansættelsestype.</li>
</ul>
</section>
<section id="spearmans-rho" class="level3">
<h3 class="anchored" data-anchor-id="spearmans-rho">Spearman’s rho</h3>
<p>Til to ordinale variable bruges korrelationskoefficienten <em>Spearman’s Rho</em> og funktionen <code>cor.test()</code> :</p>
<p>Eks: Eget uddannelsesniveau og partners uddannelsesniveau:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(<span class="fu">as.numeric</span>(df<span class="sc">$</span>udd),</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>         <span class="fu">as.numeric</span>(df<span class="sc">$</span>udd_partner),</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">method =</span> <span class="st">"spearman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Spearman's rank correlation rho

data:  as.numeric(df$udd) and as.numeric(df$udd_partner)
S = 83376532, p-value &lt; 2.2e-16
alternative hypothesis: true rho is not equal to 0
sample estimates:
      rho 
0.5101004 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Erstat udd og udd_partner med dine variable</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><p><span class="math inline">\(rho=0.5\)</span></p></li>
<li><p>Der ser ud til at være en ret solid positiv sammenhæng mellem folks eget og deres partners uddannelsesniveau</p></li>
</ul>
</section>
<section id="pearsons-r" class="level3">
<h3 class="anchored" data-anchor-id="pearsons-r">Pearsons r</h3>
<p>Til to intervalskalerede variable bruges korrelationskoefficienten Pearson’s <span class="math inline">\(r\)</span> og funktionen <code>cor.test()</code>:</p>
<p>Eks. Indkomst og antal års uddannelse.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(df<span class="sc">$</span>udd_aar, df<span class="sc">$</span>net_indkomst)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  df$udd_aar and df$net_indkomst
t = 9.2884, df = 1201, p-value &lt; 2.2e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.2053692 0.3108539
sample estimates:
      cor 
0.2588832 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Erstat udd_aar og net_indkomst med dine variable</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><span class="math inline">\(Pearsons=0.26\)</span></li>
<li>Der ser ud til at være en svag/moderat positiv sammenhæng mellem indkomst og antal års uddannelse.</li>
</ul>
</section>
</section>
<section id="t-test-for-forskelle-på-to-gennemsnit" class="level2">
<h2 class="anchored" data-anchor-id="t-test-for-forskelle-på-to-gennemsnit">T-test for forskelle på to gennemsnit</h2>
<p>Hvis vi har en skala variabel kan vi bruge hypotesetest til at undersøge, om middelværdien på denne variabel er forskellig mellem to grupper. Her vender vi tilbage til t-testen! F.eks. Er der forskel på mænd og kvinders gennemsnitlige løn?</p>
<p><strong>H0</strong>: der er ikke nogen signifikant forskel på gennemsnittet i de to grupper</p>
<p><strong>H1</strong>: der er en signifikant forskel på gennemsnittet i de to grupper</p>
<p><br></p>
<p>Brug funktionen <code>t.test()</code> og specificér de to variable:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Udfør t-test</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>ttest_resultat_bivariat <span class="ot">&lt;-</span> <span class="fu">t.test</span>(net_indkomst <span class="sc">~</span> koen, <span class="at">data =</span> df)</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Opret en tabel med resultaterne</span></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>(ttest_tabel_bivariat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Parameter =</span> <span class="fu">c</span>(<span class="st">"Gennemsnit Gruppe 1"</span>,        <span class="co"># Gennemsnit for første gruppe</span></span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Gennemsnit Gruppe 2"</span>,        <span class="co"># Gennemsnit for anden gruppe</span></span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Test-statistik"</span>,             <span class="co"># Teststatistikken (t-værdien)</span></span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">"P-værdi"</span>,                    <span class="co"># P-værdien</span></span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Nedre konfidensinterval"</span>,    <span class="co"># Nedre konfidensinterval</span></span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Øvre konfidensinterval"</span>,     <span class="co"># Øvre konfidensinterval</span></span>
<span id="cb120-12"><a href="#cb120-12" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Frihedsgrader"</span>),             <span class="co"># Frihedsgrader (df)</span></span>
<span id="cb120-13"><a href="#cb120-13" aria-hidden="true" tabindex="-1"></a>  Værdi <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb120-14"><a href="#cb120-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(ttest_resultat_bivariat<span class="sc">$</span>estimate[<span class="dv">1</span>], <span class="dv">2</span>),     <span class="co"># Gennemsnittet for første gruppe afrundet til 3 decimaler</span></span>
<span id="cb120-15"><a href="#cb120-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(ttest_resultat_bivariat<span class="sc">$</span>estimate[<span class="dv">2</span>], <span class="dv">2</span>),     <span class="co"># Gennemsnittet for anden gruppe afrundet til 3 decimaler</span></span>
<span id="cb120-16"><a href="#cb120-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(ttest_resultat_bivariat<span class="sc">$</span>statistic, <span class="dv">3</span>),       <span class="co"># Teststatistikken afrundet til 3 decimaler</span></span>
<span id="cb120-17"><a href="#cb120-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, ttest_resultat_bivariat<span class="sc">$</span>p.value),  <span class="co"># P-værdien med 4 decimaler</span></span>
<span id="cb120-18"><a href="#cb120-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(ttest_resultat_bivariat<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="dv">3</span>),     <span class="co"># Nedre konfidensinterval afrundet til 3 decimaler</span></span>
<span id="cb120-19"><a href="#cb120-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(ttest_resultat_bivariat<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="dv">3</span>),     <span class="co"># Øvre konfidensinterval afrundet til 3 decimaler</span></span>
<span id="cb120-20"><a href="#cb120-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(ttest_resultat_bivariat<span class="sc">$</span>parameter, <span class="dv">1</span>)        <span class="co"># Frihedsgrader afrundet til 1 decimal</span></span>
<span id="cb120-21"><a href="#cb120-21" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb120-22"><a href="#cb120-22" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                Parameter    Værdi
1     Gennemsnit Gruppe 1 16893.57
2     Gennemsnit Gruppe 2 15024.09
3          Test-statistik    3.996
4                 P-værdi   0.0001
5 Nedre konfidensinterval  951.613
6  Øvre konfidensinterval 2787.351
7           Frihedsgrader   1196.2</code></pre>
</div>
</div>
<ul>
<li><p>Gennemsnits netteindkomst for <span class="math inline">\(mænd=16.893\)</span> og <span class="math inline">\(kvinder=15.024\)</span> DKK</p></li>
<li><p>Siden p-værdien er mindre end 0,05 afviser vi nulhypotesen og konkluderer, at der ER en statistisk signifikant forskel på gennemsnitsindkomsten for mænd og kvinder.</p></li>
</ul>
<p>Du kan som altid eksportere tabellen med dine resultater fra testen til excel med <code>write.csv()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(writexl) </span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(ttest_tabel_bivariat, <span class="st">"t_test_resultat_bivariat.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ttest_tabel_bivariat er navnet på objektet med tabellen med t-test resultatet</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="chi2-test-for-uafhængighed" class="level2">
<h2 class="anchored" data-anchor-id="chi2-test-for-uafhængighed"><span class="math inline">\(\chi^2\)</span>-test for uafhængighed</h2>
<p>Vi kan anvende en <span class="math inline">\(\chi^2\)</span> testen til at teste, om to variable er uafhængige, eller om der ser ud til at være en statistisk sammenhæng mellem dem.</p>
<p><span class="math inline">\(\chi^2\)</span>-testen kan anvendes til kategorielle variable, dvs. variable på ordinalt eller nominalt niveau (men i øvrigt til variable på alle måleniveauer, hvis de omkodes til kategorier). Hypoteserne er som følgende:</p>
<p><strong>H0</strong>: Der er ingen sammenhæng mellem de to variabler (uafhængighed)</p>
<p><strong>H1</strong>: Der er en sammenhæng mellem de to variabler</p>
<p>F.eks. Er der en sammenhæng mellem ansættelsestype og uddannelsesniveau? Brug funktionen <code>chisq.test()</code> til at gennemføre testen og gem resultaterne i en tabel med følgende kode:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Udfør chi²-test</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>chi_resultat_bivariat <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(udd, ansaettelse_type) <span class="sc">%&gt;%</span></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(udd, ansaettelse_type) <span class="sc">%&gt;%</span></span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">chisq.test</span>()</span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Opret en data frame med chi²-testens resultater</span></span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a>(chi_tabel_bivariat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Parameter =</span> <span class="fu">c</span>(<span class="st">"Chi²-statistik"</span>,              <span class="co"># Testens Chi²-statistik</span></span>
<span id="cb123-14"><a href="#cb123-14" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Frihedsgrader"</span>,              <span class="co"># Frihedsgrader (df)</span></span>
<span id="cb123-15"><a href="#cb123-15" aria-hidden="true" tabindex="-1"></a>                <span class="st">"P-værdi"</span>),                   <span class="co"># P-værdi</span></span>
<span id="cb123-16"><a href="#cb123-16" aria-hidden="true" tabindex="-1"></a>  Værdi <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb123-17"><a href="#cb123-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(chi_resultat_bivariat<span class="sc">$</span>statistic, <span class="dv">3</span>),         <span class="co"># Chi²-statistikken afrundet til 3 decimaler</span></span>
<span id="cb123-18"><a href="#cb123-18" aria-hidden="true" tabindex="-1"></a>    chi_resultat_bivariat<span class="sc">$</span>parameter,                   <span class="co"># Frihedsgrader</span></span>
<span id="cb123-19"><a href="#cb123-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, chi_resultat_bivariat<span class="sc">$</span>p.value)    <span class="co"># P-værdien formatteret til 4 decimaler</span></span>
<span id="cb123-20"><a href="#cb123-20" aria-hidden="true" tabindex="-1"></a>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               Parameter  Værdi
X-squared Chi²-statistik  8.636
df         Frihedsgrader      6
                 P-værdi 0.1951</code></pre>
</div>
</div>
<p><span class="math inline">\(\chi^2\)</span>-testen returnerer en p-værdi på 0,2. Da det er over grænsen på 0,05 kan vi ikke forkaste nulhypotesen. Vi kan ikke afvise, at der ikke er nogen sammenhæng mellem de to variable, med udgangspunkt i denne stikprøve.</p>
<p>Du kan som altid eksportere tabellen med dine resultater fra testen til excel med <code>write.csv()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(writexl) </span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(chi_tabel_bivariat, <span class="st">"chi_resultat_bivariat.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="co"># chi_tabel_bivariat er navnet på objektet med tabellen med chi-test resultatet</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="multivariat-analyse-lineær-regression" class="level1">
<h1>Multivariat analyse (lineær regression)</h1>
<section id="installér-texreg" class="level2">
<h2 class="anchored" data-anchor-id="installér-texreg">Installér <code>texreg</code></h2>
<p>I skal bruge funktioner fra pakken <code>texreg</code> til at printe og eksportere jeres regressionstabeller. Installér <code>texreg</code> pakken som nedenfor:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"texreg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="estimation-af-en-regressionsmodel-i-r" class="level2">
<h2 class="anchored" data-anchor-id="estimation-af-en-regressionsmodel-i-r">Estimation af en regressionsmodel i R</h2>
<p>I skal bruge funktionen <code>lm()</code> til at estimere regressionsmodeller. Syntaksen er som følgende med <em>k</em> antal kontrolvariable:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(afhængig_variabel <span class="sc">~</span> uafhængig_variabel <span class="sc">+</span> kontrol_variabel_1 <span class="sc">+</span> kontrol_variabel_2 ... kontrol_variabel_k, <span class="at">data=</span>df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Resultatet af regressionsanalysen gemmes i objektet <em>model</em>. Brug <code>texreg::screenreg()</code> til at printe resultaterne i consollen:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>(texreg<span class="sc">::</span><span class="fu">screenreg</span>(<span class="fu">list</span>(model), <span class="at">include.ci =</span> F)) <span class="co"># Erstat model med navnet på objektet med den rette model</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="simpel-model" class="level2">
<h2 class="anchored" data-anchor-id="simpel-model">Simpel model</h2>
<p>Brug funktionen <code>lm()</code> til at estimere en simpel model med kun afhængig variabel (indkomst) og én uafhængig variabel (antal års uddannelse):</p>
<p><span class="math inline">\(INDK = \alpha + \beta*UDD + \epsilon\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(net_indkomst <span class="sc">~</span> udd_aar, <span class="at">data =</span> df)</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(texreg)</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>(texreg<span class="sc">::</span><span class="fu">screenreg</span>(<span class="fu">list</span>(model1), <span class="at">include.ci=</span>F))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
========================
             Model 1    
------------------------
(Intercept)  2822.64 ***
             (322.91)   
udd_aar       283.52 ***
              (22.41)   
------------------------
R^2             0.02    
Adj. R^2        0.02    
Num. obs.    9331       
========================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
<p><strong><em>Intercept</em></strong>: parameterestimatet for konstantleddet <span class="math inline">\(\alpha=10754,2\)</span> . Dette er den forventede værdi på den afhængige variabel indkomst, når værdien på den uafhængige variabel <em>antal års uddannelse</em> = 0. Altså den forventede indkomst for en person med 0 års udddannelse.</p>
<p><strong><em>udd_aar</em></strong>: parameterstimatet for <span class="math inline">\(\beta=380,33\)</span>. Dette er den forventede stigning i den afhængige variabel (indkomst<em>)</em> for hver gang den uafhængige variabel (antal års uddannelse)stiger med 1. Altså den forventede stigning i indkomst hver gang en person har 1 års uddannelse mere.</p>
<p><span class="math inline">\(R^2\)</span> <em><strong>værdi</strong>:</em> Under parameterestimaterne printes to <span class="math inline">\(R^2\)</span>-værdier. Den første, <em>R^2</em>, viser hvor stor en andel af variationen i den afhænige variabel, som kan forklares af alle de uafhængige variable i modellen. Den anden, <em>Adj. R^2,</em> viser hvor stor en andelen af variationen som forklares af signifikante uafhængige variable alene.</p>
<p><em><strong>Antal observationer</strong>:</em> I den nederste linje (<em>Num. obs</em>.) fremgår det, hvor mange observationer fra datasættet, der indgår i regressionanalysen<em>.</em></p>
<p>Derudover printer <code>texreg</code> stjerner som indikatorer for, om parameterestimater er signifikante. Forklaringen i bunden af tabellen viser, at:</p>
<p><strong>***</strong> betyder, at p-værdien for parameterestimatet er mindre end 0,001</p>
<p><strong>**</strong> betyder, at p-værdien for parameterestimatet er mindre end 0,01</p>
<p><strong>*</strong> betyder, at p-værdien for parameterestimatet er mindre end 0,05</p>
<p>Det fremgår altså af tabellen, at der er en signifikant sammenhæng mellem den afhængige variabel, <em>indkomst</em>, og uafhængige variabel <em>antal års uddannelse</em> <span class="math inline">\((p &lt; 0,001)\)</span>.</p>
<p>Tallene i parantes under hvert parameterestimat er standardfejlen.</p>
</section>
<section id="multipel-model" class="level2">
<h2 class="anchored" data-anchor-id="multipel-model">Multipel model</h2>
<p>Fremgangsmåden er den samme, når man udvider regressionsmodellen til at indeholde kontrolvariable. Kontrolvariablene tilføjes bare efter den afhængige variabel med et +</p>
<p>En multipel model med afhængig variabel (indkomst), en uafhængig variabel (antal års uddannelse) og en kontrolvariabel (alder) estimeres således:</p>
<p><span class="math inline">\(INDK = \alpha + \beta*UDD + \delta * ALDER+\epsilon\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(net_indkomst <span class="sc">~</span> udd_aar <span class="sc">+</span> alder, <span class="at">data =</span> df)</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(texreg)</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>(texreg<span class="sc">::</span><span class="fu">screenreg</span>(<span class="fu">list</span>(model2), <span class="at">include.ci=</span>F))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
========================
             Model 1    
------------------------
(Intercept)  2667.24 ***
             (466.62)   
udd_aar       285.83 ***
              (22.97)   
alder           2.39    
               (5.19)   
------------------------
R^2             0.02    
Adj. R^2        0.02    
Num. obs.    9331       
========================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</section>
<section id="forlæns-modelsøgning" class="level2">
<h2 class="anchored" data-anchor-id="forlæns-modelsøgning">Forlæns modelsøgning</h2>
<p>I forlæns modelsøgning estimerer man en række regressionsmodeller for den samme afhængige variabel <span class="math inline">\((Y)\)</span>, hvor der tilføjes flere og flere variable. Udgangspunktet for modelsøgningen er sammenhængen mellem den afhængige variabel <span class="math inline">\((Y)\)</span> og uafhængige variabel <span class="math inline">\((X)\)</span>. Herefter tilføjes løbende flere og flere kontrolvariable <span class="math inline">\((Z)\)</span>. Formålet er at forsøge af forklare den simple sammenhæng mellem <span class="math inline">\(X\)</span> og <span class="math inline">\(Y\)</span>.</p>
<p>I R estimeres en række modeller, som hver gemmes i et objekt. Dernæst bruges screenreg til at samle resultaterne i én enkelt tabel:</p>
<p>Model 1: <span class="math inline">\(INDK = \alpha + \beta*UDD + \epsilon\)</span></p>
<p>Model 2: <span class="math inline">\(INDK = \alpha + \beta*UDD + \delta * ALDER+\epsilon\)</span></p>
<p>Model 3: <span class="math inline">\(INDK = \alpha + \beta*UDD + \delta_1 * ALDER+\delta_2*FAGFORENING+\epsilon\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(net_indkomst <span class="sc">~</span> udd_aar, <span class="at">data =</span> df)</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(net_indkomst <span class="sc">~</span> udd_aar <span class="sc">+</span> alder, <span class="at">data =</span> df)</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(net_indkomst <span class="sc">~</span> udd_aar <span class="sc">+</span> alder <span class="sc">+</span> fagforening, <span class="at">data =</span> df)</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>(texreg<span class="sc">::</span><span class="fu">screenreg</span>(<span class="fu">list</span>(model1, model2, model3), <span class="at">include.ci=</span>F))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
==================================================
             Model 1      Model 2      Model 3    
--------------------------------------------------
(Intercept)  2822.64 ***  2667.24 ***  1339.34 ** 
             (322.91)     (466.62)     (441.85)   
udd_aar       283.52 ***   285.83 ***   186.52 ***
              (22.41)      (22.97)      (21.86)   
alder                        2.39        16.96 ***
                            (5.19)       (4.91)   
fagforening                            6674.25 ***
                                       (196.15)   
--------------------------------------------------
R^2             0.02         0.02         0.13    
Adj. R^2        0.02         0.02         0.13    
Num. obs.    9331         9331         9331       
==================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</section>
<section id="labels-på-regressionstabeller" class="level2">
<h2 class="anchored" data-anchor-id="labels-på-regressionstabeller">Labels på regressionstabeller</h2>
<p>Hvis du vil have pænere navne (labels) på dine koefficienter, kan det gøres således:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>texreg<span class="sc">::</span><span class="fu">screenreg</span>(<span class="fu">list</span>(model1, model2, model3), <span class="at">include.ci=</span>F,</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">custom.coef.names =</span> <span class="fu">c</span>(<span class="st">"Konstantled"</span>,</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"Antal års uddannelse"</span>,</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"Alder"</span>, </span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"Fagforeningsmedlem"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
===========================================================
                      Model 1      Model 2      Model 3    
-----------------------------------------------------------
Konstantled           2822.64 ***  2667.24 ***  1339.34 ** 
                      (322.91)     (466.62)     (441.85)   
Antal års uddannelse   283.52 ***   285.83 ***   186.52 ***
                       (22.41)      (22.97)      (21.86)   
Alder                                 2.39        16.96 ***
                                     (5.19)       (4.91)   
Fagforeningsmedlem                              6674.25 ***
                                                (196.15)   
-----------------------------------------------------------
R^2                      0.02         0.02         0.13    
Adj. R^2                 0.02         0.02         0.13    
Num. obs.             9331         9331         9331       
===========================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</section>
<section id="eksportér-regressionsmodeller" class="level2">
<h2 class="anchored" data-anchor-id="eksportér-regressionsmodeller">Eksportér regressionsmodeller</h2>
<p>Hvis man gerne vil eksportere tabeller til andre formater (f.eks. i en BA opgave, der skrives i Word eller LaTex), kan det gøres med funktionerne <code>wordreg</code>, <code>texreg</code> og <code>htmlreg</code>. Nedenfor eksporteres regressionstabellen ovenfor til hhv. word, LaTex og html-format. Filen gemmes i samme mappe på computeren, som du arbejder i:</p>
<p><strong>Word</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>texreg<span class="sc">::</span><span class="fu">wordreg</span>(<span class="fu">list</span>(model1, model2, model3),</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">custom.coef.names =</span> <span class="fu">c</span>(<span class="st">"Konstantled"</span>,</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"Antal års uddannelse"</span>,</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"Alder"</span>, </span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"Tidligere fagforeningsmedlem"</span>,</span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"Ikke fagforeningsmedlem"</span>),</span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">file =</span> <span class="st">"Regressionsresultater.doc"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>LaTeX</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>texreg<span class="sc">::</span><span class="fu">texreg</span>(<span class="fu">list</span>(model1, model2, model3),</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">custom.coef.names =</span> <span class="fu">c</span>(<span class="st">"Konstantled"</span>,</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"Antal års uddannelse"</span>,</span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"Alder"</span>, </span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"Tidligere fagforeningsmedlem"</span>,</span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"Ikke fagforeningsmedlem"</span>),</span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">file =</span> <span class="st">"Regressionsresultater.tex"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>HTML</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Html table</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>texreg<span class="sc">::</span><span class="fu">htmlreg</span>(<span class="fu">list</span>(model1, model2, model3),</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">custom.coef.names =</span> <span class="fu">c</span>(<span class="st">"Konstantled"</span>,</span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"Antal års uddannelse"</span>,</span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"Alder"</span>, </span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"Tidligere fagforeningsmedlem"</span>,</span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"Ikke fagforeningsmedlem"</span>),</span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">file =</span> <span class="st">"Regressionsresultater.html"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="forudsagte-værdier" class="level2">
<h2 class="anchored" data-anchor-id="forudsagte-værdier">Forudsagte værdier</h2>
<p>Du kan få R til at beregne de forudsagte værdier for hver observation i datasættet, baseret på en regressionsmodel, som du har estimeret. Nedenfor tilføjes en ny variabel til datasættet (<em>forudsagte_værdier</em>), med forudsagte værdier fra model 3:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>forudsagte_værdier <span class="ot">&lt;-</span> <span class="fu">predict</span>(model3, <span class="at">data =</span> df)  </span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  net_indkomst udd_aar alder fagforeningsmedlem fagforening forudsagte_værdier
         &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;                    &lt;dbl&gt;              &lt;dbl&gt;
1        20000      13    26 Nej                          0              4205.
2          530      11    65 Nej                          0              4494.
3          350      20    74 Nej                          0              6325.
4         2500      12    64 Tidligere                    0              4663.
5         4000      14    54 Nej                          0              4867.
6          570      13    20 Nej                          0              4103.</code></pre>
</div>
</div>
<p>Man kan dermed f.eks. plotte de forudsagte værdier mod de observerede:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)  </span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> forudsagte_værdier, <span class="at">y =</span> net_indkomst)) <span class="sc">+</span>   </span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span>   </span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Forudsagte værdier"</span>, <span class="at">y =</span> <span class="st">"Observerede værdier"</span>, </span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Forudsagte vs. Observerede værdier"</span>) <span class="sc">+</span>  </span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="kodeoversigt_files/figure-html/unnamed-chunk-98-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="f-test-mellem-to-modeller" class="level2">
<h2 class="anchored" data-anchor-id="f-test-mellem-to-modeller">F-test mellem to modeller</h2>
<p>F-testen bruges til at teste forklaringskraften mellem to modeller op mod hinanden, hvis der er mere end én variabel til forskel mellem dem. F-testen kan teste, om den forklaringskraft, som flere variable tilsammen tilføjer, er signifikant forskellig fra 0. Hypoteserne i en F-test for to modeller således:</p>
<p><strong>H0</strong>: model 3 forklarer ikke singifikant mere end model 2</p>
<p><strong>H1</strong>: model 3 forklarer signifikant mere end model 2</p>
<p>Testen gennemføres i R således:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>f_test <span class="ot">&lt;-</span> <span class="fu">anova</span>(model2, model3)</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>(f_test_summary <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Forskel i Frihedsgrader"</span> <span class="ot">=</span> f_test<span class="sc">$</span>Df[<span class="dv">2</span>],        <span class="co"># Forskel i frihedsgrader</span></span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"F-statistik"</span> <span class="ot">=</span> f_test<span class="sc">$</span>F[<span class="dv">2</span>],                     <span class="co"># F-statistik</span></span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"P-værdi"</span> <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, f_test<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;F)</span><span class="st">`</span>[<span class="dv">2</span>]), <span class="co"># P-værdi med 4 decimaler</span></span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">check.names =</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Forskel i Frihedsgrader F-statistik P-værdi
1                       1    1157.793  0.0000</code></pre>
</div>
</div>
<p>P-værdien på mindre end 0,0000 viser, at vi afviser H0 og accepterer H1. Model 3 forklarer signifikant mere end model 2.</p>
</section>
<section id="heteroskedasticitet" class="level2">
<h2 class="anchored" data-anchor-id="heteroskedasticitet">Heteroskedasticitet</h2>
<p>Hvis en regressionsmodel lider af heteroskedasticitet bliver vores p-værdier upålidelige. Derfor er det god skik at undersøge, om der er heteroskedasticitet tilstede i en model. Det gøres typisk ved grafisk inspektion eller med en statistisk test, <em>Breush Pagan Testen</em>.</p>
<section id="grafisk-inspektion" class="level3">
<h3 class="anchored" data-anchor-id="grafisk-inspektion">Grafisk inspektion</h3>
<p>Lav et plot af residualerne mod de forudsagte værdier fra model 3 for at inspicere modellen for heteroskedasticitet:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Beregn forudsagte værdier</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(model3)</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Beregn residualer</span></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>residuals <span class="ot">&lt;-</span> <span class="fu">resid</span>(model3)</span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Lav plot dataframe</span></span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">predicted =</span> predicted, <span class="at">residuals =</span> residuals)</span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Opret et plot for heteroskedasticitet</span></span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> predicted, <span class="at">y =</span> residuals)) <span class="sc">+</span></span>
<span id="cb145-12"><a href="#cb145-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">20</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span> <span class="co"># Sæt punktform og farve (runde, sorte punkter)</span></span>
<span id="cb145-13"><a href="#cb145-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb145-14"><a href="#cb145-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Forudsagte værdier"</span>,            <span class="co"># Navn til x-aksen</span></span>
<span id="cb145-15"><a href="#cb145-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Residualer"</span>,                    <span class="co"># Navn til y-aksen</span></span>
<span id="cb145-16"><a href="#cb145-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Plot for heteroskedasticitet"</span> <span class="co"># Titel til plottet</span></span>
<span id="cb145-17"><a href="#cb145-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb145-18"><a href="#cb145-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span>                      <span class="co"># Brug et minimalistisk tema</span></span>
<span id="cb145-19"><a href="#cb145-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb145-20"><a href="#cb145-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="co"># Centrér titlen vandret (hjust = 0.5)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="kodeoversigt_files/figure-html/unnamed-chunk-100-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>For at vurdere heteroskedasticitet i plottet, skal man kigge på mønsteret i fordelingen af residualerne (y-aksen) mod de forudsagte værdier (x-aksen). Hvis spredningen af residualerne øges eller mindskes systematisk, efterhånden som de forudsagte værdier vokser, er der sandsynligvis heteroskedasticitet. F.eks. kan det tyde på heteroskadesticitet, hvis residualerne lægger sig i mønstre som en vaffel/tragt, vifte eller parabler.</p>
<p>Plottet viser en vis ændring i spredningen, hvor residualerne ser ud til at have en smule bredere spredning i de lave værdier på x-aksen end i de højere. Dette kan indikere noget heteroskedasticitet, men det er ikke meget udtalt.</p>
</section>
<section id="breush-pagan-test" class="level3">
<h3 class="anchored" data-anchor-id="breush-pagan-test">Breush Pagan Test</h3>
<p>For formelt at teste for heteroskedasticitet kan man bruge <em>Breush Pagan Testen.</em> Hypoteserne er som følgende:</p>
<p><strong>H0</strong>: Der er <em>ingen</em> heteroskedasticitet</p>
<p><strong>H1</strong>: Der <em>er</em> heteroskedasticitet</p>
<p>Testen udføres i R som følgende:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>bptest_result <span class="ot">&lt;-</span> <span class="fu">bptest</span>(model3)</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>(bptest_summary <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Teststatistik</span><span class="st">`</span> <span class="ot">=</span> bptest_result<span class="sc">$</span>statistic,       <span class="co"># Teststatistik</span></span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Frihedsgrader</span><span class="st">`</span> <span class="ot">=</span> bptest_result<span class="sc">$</span>parameter,       <span class="co"># Frihedsgrader</span></span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">P-værdi</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, bptest_result<span class="sc">$</span>p.value) <span class="co"># P-værdi med 4 decimaler</span></span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Teststatistik Frihedsgrader P.værdi
BP      515.2487             3  0.0000</code></pre>
</div>
</div>
<p>P-værdien på mindre end 0,0000 viser, at vi kan afvise nulhypotesen og accepterer H1. Der er altså heteroskedasticitet tilstede.</p>
</section>
<section id="robuste-standardfejl" class="level3">
<h3 class="anchored" data-anchor-id="robuste-standardfejl">Robuste standardfejl</h3>
<p>Hvis der er heteroskedasticitet tilstede i en regressionsmodel er det nødvendigt at estimere den igen med robuste standardfejl. Det gøres med funktionen <code>lm_robust</code> fra pakken <code>estimatr</code> :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(estimatr)</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>model_robust <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>(net_indkomst <span class="sc">~</span> udd_aar <span class="sc">+</span> alder <span class="sc">+</span> fagforening, <span class="at">data =</span> df)</span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>(texreg<span class="sc">::</span><span class="fu">screenreg</span>(<span class="fu">list</span>(model_robust), <span class="at">include.ci=</span>F,</span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">custom.coef.names =</span> <span class="fu">c</span>(<span class="st">"Konstantled"</span>,</span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"Antal års uddannelse"</span>,</span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"Alder"</span>, </span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"Fagforeningsmedlem"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=================================
                      Model 1    
---------------------------------
Konstantled           1339.34 ** 
                      (421.53)   
Antal års uddannelse   186.52 ***
                       (23.10)   
Alder                   16.96 ***
                        (4.24)   
Fagforeningsmedlem    6674.25 ***
                      (228.88)   
---------------------------------
R^2                      0.13    
Adj. R^2                 0.13    
Num. obs.             9331       
RMSE                  8475.94    
=================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<div id="toc-logo">

  <img src="ilisimatusarfik.png" alt="Logo">

</div>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>