---
format: 
  revealjs:
    theme: css_etc/custom-theme-ilisimatusarfik.css
    slide-level: 0  # Disable automatic slide creation from headings
    incremental: false 
    logo: css_etc/ilisimatusarfik.png
    highlight: true
    highlight-style: github-dark
editor: visual
---

::: center
# Grundl√¶ggende univariat analyse

### Statistik E24 (15 ECTS)

### ved Mikkeline Munk Nielsen
:::

------------------------------------------------------------------------

# Hvad er univariat analyse?

-   Uni er latin for √©n eller et, dvs. analyser med kun √©n enkelt variabel
-   Univariat analyse falder inden for ***deskriptiv*** (beskrivende) statistik i mods√¶tning til ***inferentiel*** (forklarende) statistik
-   I univariat analyse beskriver vi fordelingen af √©n variabel.
-   Vi bruger univariat analyse til at skabe overblik over et karakteristikum i en population, f.eks. at beskrive indkomstfordelingen i en population

------------------------------------------------------------------------

# Hvad er univariat analyse?

Typer af sp√∏rgsm√•l vi kan besvare med univariat analyse:

-   Hvordan ser fordelingen af denne variabel ud? ‚Üí tabeller eller plots

-   Hvad er den typiske v√¶rdi p√• denne variabel? ‚Üí centrumm√•l

-   Er der meget stor forskel p√•, hvilke v√¶rdier forskellige observationer har p√• denne variabel? ‚Üí spredningsm√•l

------------------------------------------------------------------------

## Eksempel med datas√¶t

Greenlandics Perspectives Survey fra Ilisimatusarfik

::: panel-tabset
### Datas√¶t

```{r, echo=F}
(df <- readRDS("data/GL_vaelger_adfaerd_1989.rds"))

```

### Kode

```{r, echo=TRUE}
getwd()
df <- readRDS("data/GL_vaelger_adfaerd_1989.rds")
```
:::

------------------------------------------------------------------------

# Frekvenser

Sp√∏rgsm√•let `V8_Samarbejde_Inuit_Norden` er f√∏lgende: *Hvilket af f√∏lgende synspunkter om samarbejde er du mest enig i?*

::: {style="font-size: 0.8em; border-collapse: collapse; width: 100%;"}
| V√¶rdi | Svar |
|----------------------|--------------------------------------------------|
| 1 | Samarbejde med inuit i Canada, Alaska og Sibrien b√∏r g√• forud for samarbejdet med de nordiske lande |
| 2 | Samarbejde med de nordiske lande b√∏r g√• forud for samarbejde med inuit i Canada, Alaska og Sibrien |
| 3 | Samarbejde med inuit i Canada, Alaska og Sibrien og samarbejde med de nordiske lande er lige vigtigt |
| 4 | Ved ikke |
| NA | Ikke oplyst |
:::

------------------------------------------------------------------------

# Frekvenser

En typisk m√•de at opsummere frekvenser er via. frekvenstabeller (evt. procenter)

::: panel-tabset
### Envejstabel

```{r, echo=F}
library(janitor) 
tabyl(df, V8_Samarbejde_Inuit_Norden)
```

### Kode

```{r, echo=TRUE, eval=F}
library(janitor) 
tabyl(df, V8_Samarbejde_Inuit_Norden)
```
:::

------------------------------------------------------------------------

# Frekvenser

Frekvenser visualeres ogs√• ofte via. s√∏jlediagrammer:

::: panel-tabset
### S√∏jlediagram / barplot

```{r, echo=F}
library(ggplot2)

ggplot(df, aes(x = factor(V8_Samarbejde_Inuit_Norden, exclude = NULL))) + 
  geom_bar(fill = "#003366", na.rm = FALSE) + 
  labs(
    x = "Svar",
    y = "Frekvens"
  )
```

### Kode

```{r, echo=TRUE, eval=F}
library(ggplot2)

ggplot(df, aes(x = factor(V8_Samarbejde_Inuit_Norden, exclude = NULL))) + 
  geom_bar(fill = "#003366", na.rm = FALSE) + 
  labs(
    x = "Svar",
    y = "Frekvens"
  )
```
:::

------------------------------------------------------------------------

# Andele

-   Andele beskriver relativ frekvens/hyppighed

-   Andelsfunktion: $g(z) = \frac{\text{antal observationer med v√¶rdien } z}{\text{Antallet af observationer}}$

<br>

::: panel-tabset
### Envejstabel

```{r, echo=F}
library(janitor) 
tabyl(df, V8_Samarbejde_Inuit_Norden)
```

### Kode

```{r, echo=TRUE, eval=F}
library(janitor) 
tabyl(df, V8_Samarbejde_Inuit_Norden)
```
:::

------------------------------------------------------------------------

# Andele

Andele kan f.eks. visualiseres med s√∏jlediagrammer (barplots)...

::: panel-tabset
### S√∏jlediagram (procent)

```{r, echo=F}
library(ggplot2)

ggplot(df, aes(x = factor(V8_Samarbejde_Inuit_Norden, exclude = NULL))) + 
  geom_bar(aes(y = (..count..) / sum(..count..) * 100), 
           fill = "#003366", na.rm = FALSE) + 
  labs(
    x = "Svar",
    y = "Procent"
  )
```

### Kode

```{r, echo=TRUE, eval=F}
library(ggplot2)

ggplot(df, aes(x = factor(V8_Samarbejde_Inuit_Norden, exclude = NULL))) + 
  geom_bar(aes(y = (..count..) / sum(..count..) * 100), 
           fill = "#003366", na.rm = FALSE) + 
  labs(
    x = "Svar",
    y = "Procent"
  )
```
:::

------------------------------------------------------------------------

# Andele

... eller cirkeldiagrammer

::: panel-tabset
### S√∏jlediagram (procent)

```{r echo=F}
library(dplyr)
library(ggplot2)

# Beregn procenterne manuelt
df_pie <- df %>%
  group_by(V8_Samarbejde_Inuit_Norden) %>%
  summarise(count = n()) %>%
  mutate(percentage = count / sum(count) * 100)

# Opret cirkeldiagrammet med procenter og hvid tekst
ggplot(df_pie, aes(x = "", y = percentage, fill = factor(V8_Samarbejde_Inuit_Norden))) + 
  geom_bar(stat = "identity", width = 1) + 
  coord_polar(theta = "y") + 
  geom_text(aes(label = paste0(round(percentage, 1), "%")), 
            position = position_stack(vjust = 0.5), 
            color = "white") +  # G√∏r teksten hvid
  labs(x = NULL, y = NULL, fill = "Svar") +
  theme_void() +  # Fjerner akse-linjer og labels
  scale_fill_manual(values = c("#003366", "#6699CC", "#336699", "#99CCFF", "#0066CC"))  # Bl√• farver
```

### Kode

```{r echo=T, eval=F}
library(dplyr)
library(ggplot2)

# Beregn procenterne manuelt
df_pie <- df %>%
  group_by(V8_Samarbejde_Inuit_Norden) %>%
  summarise(count = n()) %>%
  mutate(percentage = count / sum(count) * 100)

# Opret cirkeldiagrammet med procenter og hvid tekst
ggplot(df_pie, aes(x = "", y = percentage, fill = factor(V8_Samarbejde_Inuit_Norden))) + 
  geom_bar(stat = "identity", width = 1) + 
  coord_polar(theta = "y") + 
  geom_text(aes(label = paste0(round(percentage, 1), "%")), 
            position = position_stack(vjust = 0.5), 
            color = "white") +  # G√∏r teksten hvid
  labs(x = NULL, y = NULL, fill = "Svar") +
  theme_void() +  # Fjerner akse-linjer og labels
  scale_fill_manual(values = c("#003366", "#6699CC", "#336699", "#99CCFF", "#0066CC"))  # Farver
```
:::

------------------------------------------------------------------------

# Andele

-   Kummulativ andelsfunktion: $g(z) = \frac{\text{antal observationer} \leq z}{\text{antallet af observationer}}$

-   F√∏rst rigtig meningsfuld, n√•r v√¶rdier kan rangordnes (fra ordinalt m√•leniveau)

-   V42_Alder_Grupperet: *Hvor gammel er du?*

::: {style="font-size: 0.8em; border-collapse: collapse; width: 100%;"}
| V√¶rdi | Svar       |
|-------|------------|
| 1     | 18 - 19 √•r |
| 2     | 20 - 29 √•r |
| 3     | 30 - 39 √•r |
| 4     | 40 - 49 √•r |
| 5     | 50 - 59 √•r |
| 6     | 60 - 69 √•r |
| 7     | Over 70 √•r |
| NA    | Uoplyst    |
:::

------------------------------------------------------------------------

# Andele

::: panel-tabset
### S√∏jlediagram

```{r, echo=F}
# S√∏rg for, at aldersgruppen er en faktor med de rigtige niveauer (uden NA som niveau)
df$V42_Alder_Grupperet <- factor(df$V42_Alder_Grupperet, 
                                  levels = c(1, 2, 3, 4, 5, 6, 7), 
                                  labels = c("18 - 19 √•r", "20 - 29 √•r", "30 - 39 √•r", "40 - 49 √•r", 
                                             "50 - 59 √•r", "60 - 69 √•r", "Over 70 √•r"))

# Opret barplot med de rigtige aldersgrupper p√• x-aksen
ggplot(df, aes(x = V42_Alder_Grupperet)) + 
  geom_bar(aes(y = cumsum(..count..) / sum(..count..) * 100), 
           stat = "count", fill = "#003366") + 
  labs(
    x = "Aldersgruppe",
    y = "Kumulativ andel"
  ) +
  scale_x_discrete(drop = FALSE)  # Sikrer, at alle kategorier inkl. "Uoplyst" vises

```

### Kode

```{r echo=T, eval=F}
library(ggplot2)

# S√∏rg for, at aldersgruppen er en faktor med de rigtige niveauer (uden NA som niveau)
df$V42_Alder_Grupperet <- factor(
  df$V42_Alder_Grupperet, 
  levels = c(1, 2, 3, 4, 5, 6, 7), 
  labels = c("18 - 19 √•r", "20 - 29 √•r", 
             "30 - 39 √•r", "40 - 49 √•r", 
              "50 - 59 √•r", "60 - 69 √•r", 
             "Over 70 √•r"))

# Opret barplot med de rigtige aldersgrupper p√• x-aksen
ggplot(df, aes(x = V42_Alder_Grupperet)) + 
  geom_bar(aes(y = cumsum(..count..) / sum(..count..) * 100), 
           stat = "count", fill = "#003366") + 
  labs(
    x = "Aldersgruppe",
    y = "Kumulativ andel") +
  scale_x_discrete(drop = FALSE)  # Vis alle kategorier

```
:::

------------------------------------------------------------------------

# M√•l for den centrale tendens (centrumm√•l)

M√•l for en variabels centrale tendens siger noget om en ‚Äùtypiske‚Äù v√¶rdi p√• variablen. Man taler oftest om tre centrumm√•l:

<br>

-   **Typetal**: den v√¶rdi, der optr√¶der flest gange (kaldes ogs√• modus eller modalv√¶rdi)

-   **Middelv√¶rdi/gennemsnit**: $\bar{x} = \frac{1}{N} \sum_{i=1}^{N} x_i$

-   **Median**: v√¶rdien af den midterste observation eller gennemsnittet mellem de to midterste (den v√¶rdi, der deler enhederne i to lige store dele).

------------------------------------------------------------------------

# Typetal

Den v√¶rdi, der optr√¶der flest gange (kaldes ogs√• modus eller modalv√¶rdi)

-   Vi kan bruge`Mode()` funktionen fra pakken `DescTools` til at finde typetallet

-   Dog skal vi specificere for funktionen, at den skal ignorere missing v√¶rdier (`NA`'s)

```{r echo=T}
library(DescTools)
(mode <- Mode(df$V8_Samarbejde_Inuit_Norden, na.rm = TRUE))
```

-   `Mode()` fort√¶ller os, at typetallet er 3, og at det optr√¶der 617 gange i datas√¶ttet

------------------------------------------------------------------------

# Middelv√¶rdi

-   Det mest brugte centrumm√•l er middelv√¶rdien, bedre kendt som gennemsnittet

-   Gennemsnittet er defineret som $\bar{x} = \frac{1}{N} \sum_{i=1}^{N} x_i$

-   Det beregnes alts√• ved at l√¶gge alle v√¶rdierne p√• en variabel sammen og dividere med antallet af v√¶rdier/observationer. Det er derfor f√∏lsomt over for meget store eller meget sm√• v√¶rdier, som kan tr√¶kke gennemsnittet op eller ned.

```{r echo=T}
Mean(df$V8_Samarbejde_Inuit_Norden, na.rm = T)
```

------------------------------------------------------------------------

# Median

-   Medianen er et m√•l for den "midterste v√¶rdi" p√• en variabel, n√•r v√¶rdierne er rangeret i stigende r√¶kkef√∏lge.

-   De enkelte empiriske observationer af en variabel $(Z)$ noteres som $a$ tildeles et nummer svarende til den enhed (f.eks. individ), der er observeret: $a_1, a_2, a_3, ... a_n$. Dern√¶st rangordnes observationerne efter v√¶rdi:

    <br>

    |     |     |     |     |     |     |     |     |     |     |
    |-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|
    | 18  | 26  | 32  | 34  | 41  | 48  | 55  | 62  | 74  | 78  |

------------------------------------------------------------------------

# Median

-   Hvis der er et lige antal observationer er medianen gennemsnittet af de to midterste tal.

    $$
    \text{Median} = \frac{x_{\left(\frac{n}{2}\right)} + x_{\left(\frac{n}{2} + 1\right)}}{2}
    $$

-   Hvis der er et ulige antal observationer er medianen det midterste tal i r√¶kken

    $$
    \text{Median} = x_{\left(\frac{n+1}{2}\right)}
    $$

------------------------------------------------------------------------

# Centrumm√•l

√òvelse: find eksempler p√•, hvorn√•r hvert af disse centrumm√•l er interessante at anvende

<br>

-   Typetal

-   Middelv√¶rdi

-   Median

---

# Centrumm√•l

<br>

::: {style="width: 100%; font-size: 1em; border-collapse: collapse;"}
|                | **Nominel** | **Ordinal** | **Interval** |
|----------------|-------------|-------------|--------------|
| **Typetal**    | ‚úì           | ‚úì           | ‚úì\*          |
| **Median**     |             | ‚úì           | ‚úì            |
| **Gennemsnit** |             |             | ‚úì            |
:::

<br>

::: aside
\*Typisk kun meningsfuld for variable med diskrete v√¶rdier
:::

------------------------------------------------------------------------

# Fraktiler

-   Intuitionen bag medianen er, at halvdelen af observationerne vil v√¶re st√∏rre end medianen og halvdelen af observationerne vil v√¶re mindre end medianen.

-   Medianen er et tilf√¶lde af typen af statistiske m√•l, der hedder ***fraktiler***

-   En $p$-fraktil er en v√¶rdi, hvor andelen $p$ af elementerne i en population har en v√¶rdi mindre end $p$ fraktilen. Medianen er alts√• 0,5 fraktilen

-   Andre nyttige fraktiler er $0,25$ og $0,75$ fraktiler. Tilsammen kaldes $0,25$, $0,50$, og $0,75$ fraktilerne for ***kvartiler***, da de inddeler enhederne i fire lige store grupper

    ```{r echo=T}
    Median(df$V41_Alder_Ikke_Grupperet, na.rm=T)
    ```

    ```{r}
    quantile(df$V41_Alder_Ikke_Grupperet, probs = c(0.25, 0.75), na.rm = TRUE)
    ```

------------------------------------------------------------------------

# Boksplot

Fraktiler kan visualiseres ved hj√¶lp af boksplots, der viser: `min`, `p25`, `p50`, `p75`, og `max`

::: panel-tabset
### S√∏jlediagram

```{r echo=F}
library(ggplot2)

ggplot(df, aes(x = V41_Alder_Ikke_Grupperet)) +
  geom_boxplot() +  # Opretter et boxplot baseret p√• variablen V41_Alder_Ikke_Grupperet
  theme_minimal() +  # Anvender et minimalistisk tema uden un√∏dvendige baggrundselementer
  labs(
    x = "Alder (ikke grupperet)"  # Tilf√∏jer en brugerdefineret titel til x-aksen
  ) +
  scale_x_continuous(breaks = 
            seq(min(df$V41_Alder_Ikke_Grupperet, na.rm = TRUE), 
            max(df$V41_Alder_Ikke_Grupperet, na.rm = TRUE), 
            by = 2)) +  # Indstiller x-aksen til at have ticks for hver 2. v√¶rdi fra minimum til maksimum af data
  theme(
    axis.text.y = element_blank(),  # Fjerner tekstetiketterne (v√¶rdierne) p√• y-aksen
    axis.ticks.y = element_blank()  # Fjerner ticks (stregmarkeringer) p√• y-aksen
  ) +
    coord_fixed(ratio = 25)  # Just√©r p√• h√∏jden af boksplottet
```

### Kode

```{r echo=T, eval=F}
library(ggplot2)

ggplot(df, aes(x = V41_Alder_Ikke_Grupperet)) +
  geom_boxplot() +  # Opretter et boxplot baseret p√• variablen V41_Alder_Ikke_Grupperet
  theme_minimal() +  # Anvender et minimalistisk tema uden un√∏dvendige baggrundselementer
  labs(
    x = "Alder (ikke grupperet)"  # Tilf√∏jer en brugerdefineret titel til x-aksen
  ) +
  scale_x_continuous(breaks = 
            seq(min(df$V41_Alder_Ikke_Grupperet, na.rm = TRUE), 
            max(df$V41_Alder_Ikke_Grupperet, na.rm = TRUE), 
            by = 2)) +  # Indstiller x-aksen til at have ticks for 
                        # hver 2. v√¶rdi fra minimum til maksimum af data
  theme(
    axis.text.y = element_blank(),  # Fjerner tekstetiketterne (v√¶rdierne) p√• y-aksen
    axis.ticks.y = element_blank()  # Fjerner ticks (stregmarkeringer) p√• y-aksen
  ) +
    coord_fixed(ratio = 25)  # Just√©r p√• h√∏jden af boksplottet
```
:::

------------------------------------------------------------------------

# Spredningsm√•l

-   Udover den ‚Äùtypiske v√¶rdi‚Äù er det informativt at unders√∏ge spredningen p√• en variabel, dvs. hvor langt de forskellige enheders v√¶rdier ligger fra hinanden.

-   Spredningsm√•l siger alts√• noget om variationen i data, og besk√¶ftiger sig med, hvor meget observationerne afviger fra middelv√¶rdien

-   Der er to hovedbegreber i statistik for spredningsm√•l\*:

    -   Varians: $Var(x)$ eller $\sigma^2{(x)}$

    -   Standardafvigelse: $sd(x)$ eller $\sigma{(x)}$

------------------------------------------------------------------------

# Varians

-   Variansen siger noget om, hvor stor spredning, der er p√• en variabel. Med andre ord, ligger observationerne kort eller langt fra middelv√¶rdien?

-   Variansen er givet ved gennemsnittet af de kvardrerede afstande mellem hver observation og middelv√¶rdien:

$$
\text{Var}(x) = \sigma^2(x) = \frac{1}{N} \sum_{i=1}^{N} (x_i - \bar{x})^2
$$

\- $N$ er antallet af observationer

\- $x_i$ er den enkelte observation

\- $\bar{x}$ er gennemsnittet

---

# Varians

```{r echo=T}
data <- c(3, 5, 7, 8, 10, 12, 15, 18, 20, 25)
mean_value <- mean(data)
```

```{r, echo=F}
# Dataserie
data <- c(3, 5, 7, 8, 10, 12, 15, 18, 20, 25)
mean_value <- mean(data)

# Generer tilf√¶ldige y-v√¶rdier
set.seed(42)  # For reproducerbarhed
y_vals_random <- runif(length(data), min = 0.5, max = length(data) + 0.5)

# Plot af observationer (scatterplot)
plot(data, y_vals_random, pch = 19, xlim = c(min(data) - 5, max(data) + 5), ylim = c(0.5, length(data) + 0.5),
     xlab = "Observationer", ylab = "", axes = FALSE)

# Tilf√∏j gennemsnittet som en r√∏d linje
abline(v = mean_value, col = "red", lty = 2, lwd = 2)

# Tilf√∏j pile for hver observation, der peger p√• gennemsnittet
arrows(x0 = data, y0 = y_vals_random, x1 = rep(mean_value, length(data)), y1 = y_vals_random,
       col = "blue", length = 0.1, angle = 20)

# Tilf√∏j kun x-akse
axis(1)

```

---

# Standardafvigelse

-   Tager du kvadratroden af variansen, f√•r du standardafvigelsen (ùëÜ), som er angivet i samme enhed som variablen (f.eks. √•r eller kroner)

$$
\text{Var}(x) = \sigma^2(x) = \frac{1}{N} \sum_{i=1}^{N} (x_i - \bar{x})^2
$$

$$
\text{sd}(x)= \sigma(x)=\sqrt{\sigma(x)^2}=\sqrt{\sigma^2(x) = \frac{1}{N} \sum_{i=1}^{N} (x_i - \bar{x})^2}
$$

-   Standardafvigelsen udtrykker kvadratroden af den gennemsnitlige kvadrerede afvigelse fra gennemsnittet p√• en variabel

-   Den er med andre ord t√¶t p√• at v√¶re et m√•l for den gennemsnitlige afvigelse fra gennemsnittet p√• en variabel, p√• variablens oprindelige skala - derfor bruges den ofte deskriptivt

---

# Opsamling

|                   |         |         |          |
|-------------------|---------|---------|----------|
|                   | Nominal | Ordinal | Interval |
| Typetal           | ‚úì       | ‚úì       | ‚úì        |
| Median            |         | ‚úì       | ‚úì        |
| Middelv√¶rdi       |         | (‚úì)     | ‚úì        |
| Standardafvigelse |         |         | ‚úì        |
